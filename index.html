<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yusuf Store 25 - Pusat Sepatu Padang Sidimpuan</title>
    <meta name="title" content="Yusuf Store 25 - Pusat Sepatu Padang Sidimpuan">
    <meta name="description" content="Pusat sepatu berkualitas di Padang Sidimpuan. Menyediakan sepatu Running, Casual, Futsal, basket, dan Jam Tangan Original & Premium.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="index.html">
    <meta property="og:title" content="Yusuf Store 25 - Pusat Sepatu Padang Sidimpuan">
    <meta property="og:description" content="Temukan sepatu favoritmu di sini! Lokasi: Depan Tugu Salak. Klik untuk lihat katalog.">
    <meta property="og:image" content="1000108714.jpg">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&family=Russo+One&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Poppins', 'sans-serif'], display: ['Russo One', 'sans-serif'] },
                    colors: { primary: '#000000', accent: '#ccff00', secondary: '#18181b', cardbg: '#121212', mute: '#a1a1aa' }
                }
            }
        }
    </script>
    <style>
        html { scroll-behavior: smooth; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .brand-logo:hover { transform: scale(1.05); border-color: #ccff00; box-shadow: 0 0 15px rgba(204, 255, 0, 0.3); }
        .product-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px -10px rgba(204, 255, 0, 0.15); border-color: #ccff00; }
        #imageModal, #adminModal, #testimoniModal { backdrop-filter: blur(8px); }
        .nav-link.active { color: #ccff00; font-weight: 700; text-shadow: 0 0 10px rgba(204, 255, 0, 0.3); }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        .float-btn { animation: float 3s ease-in-out infinite; }
        details > summary { list-style: none; }
        details > summary::-webkit-details-marker { display: none; }
        details[open] summary ~ * { animation: sweep .3s ease-in-out; }
        @keyframes sweep { 0% {opacity: 0; transform: translateY(-10px)} 100% {opacity: 1; transform: translateY(0)} }
        ::selection { background-color: #ccff00; color: #000; }
        /* Custom Checkbox for Sizes */
        .size-checkbox:checked + div { background-color: #ccff00; color: black; border-color: #ccff00; }
    </style>
</head>
<body class="bg-primary text-gray-200 font-sans pt-16 md:pt-20 min-h-screen selection:bg-accent selection:text-black">

    <!-- Navbar -->
    <nav class="bg-black/90 backdrop-blur-md border-b border-white/10 fixed w-full z-50 top-0">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="#" class="flex items-center gap-2 group" onclick="showSection('home-section'); resetFilter(); return false;">
                <img src="1000108714.jpg" alt="Logo" class="h-10 w-10 md:h-12 md:w-12 object-cover rounded-full border-2 border-transparent group-hover:border-accent transition duration-300">
                <div class="hidden md:block">
                    <h1 class="font-display font-bold text-xl leading-none text-white tracking-wide group-hover:text-accent transition">Yusuf Store 25</h1>
                    <p class="text-xs text-gray-400 font-mono">Padang Sidimpuan</p>
                </div>
            </a>
            <div class="hidden md:flex items-center space-x-8 text-sm font-bold tracking-wide uppercase">
                <a href="#" onclick="showSection('home-section'); return false;" class="nav-link text-gray-300 hover:text-accent transition">Beranda</a>
                <a href="#" onclick="showSection('catalog'); return false;" class="nav-link text-gray-300 hover:text-accent transition">Katalog</a>
                <a href="#" onclick="showSection('gallery'); return false;" class="nav-link text-gray-300 hover:text-accent transition">Galeri</a>
                <a href="#" onclick="showSection('testimonials'); return false;" class="nav-link text-gray-300 hover:text-accent transition">Testimoni</a>
                <a href="#" onclick="showSection('sizeguide'); return false;" class="nav-link text-gray-300 hover:text-accent transition">Size Guide</a>
            </div>
            <div class="hidden md:flex flex-1 mx-6 justify-end relative">
                <input type="text" id="desktopSearch" placeholder="Cari sneakers..." class="w-48 lg:w-64 bg-zinc-900 border border-zinc-700 rounded-full py-2 px-4 text-sm text-white focus:outline-none focus:border-accent focus:ring-1 focus:ring-accent transition placeholder-gray-600" onkeyup="searchProduct(this.value); showSection('catalog');">
                <button class="absolute right-3 top-2.5 text-gray-500 hover:text-accent"><i class="fas fa-search text-sm"></i></button>
            </div>
            <div class="flex items-center gap-5">
                <a href="https://www.instagram.com/yusuf_store_25?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw%3D%3D" target="_blank" class="text-gray-300 hover:text-accent text-2xl transition"><i class="fab fa-instagram"></i></a>
                <button class="md:hidden text-2xl text-white hover:text-accent transition" onclick="toggleMenu()"><i class="fas fa-bars"></i></button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden bg-zinc-900 border-t border-white/10 p-4 md:hidden text-white">
            <input type="text" placeholder="Cari barang..." class="w-full bg-black border border-zinc-700 p-2 rounded mb-4 focus:border-accent outline-none" onkeyup="searchProduct(this.value); showSection('catalog'); toggleMenu();">
            <ul class="space-y-4 font-bold uppercase text-sm tracking-wider">
                <li><a href="#" class="block hover:text-accent" onclick="showSection('home-section'); toggleMenu(); return false;">Beranda</a></li>
                <li><a href="#" class="block hover:text-accent" onclick="showSection('catalog'); toggleMenu(); return false;">Katalog</a></li>
                <li><a href="#" class="block hover:text-accent" onclick="showSection('gallery'); toggleMenu(); return false;">Galeri</a></li>
                <li><a href="#" class="block hover:text-accent" onclick="showSection('testimonials'); toggleMenu(); return false;">Testimoni</a></li>
                <li><a href="#" class="block hover:text-accent" onclick="showSection('sizeguide'); toggleMenu(); return false;">Size Guide</a></li>
                <li><a href="#shipping-location-section" class="block hover:text-accent" onclick="showSection('shipping-location-section'); toggleMenu(); return false;">Cek Ongkir & Lokasi</a></li>
            </ul>
        </div>
    </nav>

    <a href="https://wa.me/6281375861195" target="_blank" class="fixed bottom-6 right-6 z-50 float-btn bg-accent hover:bg-white text-black w-14 h-14 rounded-full shadow-[0_0_20px_rgba(204,255,0,0.4)] flex items-center justify-center text-3xl transition duration-300 border-2 border-black"><i class="fab fa-whatsapp"></i></a>

    <main id="main-content">
        <!-- Home Section -->
        <div id="home-section" class="page-section">
            <section class="relative h-[350px] md:h-[450px] w-full overflow-hidden bg-black">
                <img id="heroImage" src="https://images.unsplash.com/photo-1552346154-21d32810aba3?q=80&w=2070&auto=format&fit=crop" alt="Banner Utama" class="w-full h-full object-cover opacity-40 grayscale hover:grayscale-0 transition duration-700">
                <div class="absolute top-4 right-2 md:top-12 md:right-16 z-30 transform rotate-12 hover:rotate-0 transition duration-500 cursor-default">
                    <div class="bg-accent text-black font-black text-[10px] md:text-base px-2 py-1 md:px-4 md:py-2 rounded-lg shadow-[0_0_20px_rgba(0,0,0,0.5)] border-2 border-black text-center leading-tight uppercase animate-pulse">
                        Barang Ready<br><span class="text-red-600 font-extrabold">& Bisa PO!</span>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"></div>
                <div class="absolute inset-0 flex flex-col justify-center items-center text-center p-4">
                    <img src="1000108714.jpg" alt="Logo" class="w-24 h-24 md:w-32 md:h-32 mb-6 rounded-full border-4 border-accent shadow-[0_0_30px_rgba(204,255,0,0.3)] object-cover">
                    <div class="mb-4">
                        <h2 id="heroTitle" class="text-3xl md:text-5xl font-display uppercase text-transparent bg-clip-text bg-gradient-to-r from-white via-accent to-white drop-shadow-[0_0_10px_rgba(204,255,0,0.5)] tracking-wider">Yusuf Store 25</h2>
                        <p id="heroSubtitle" class="text-[10px] md:text-sm text-gray-300 font-mono mt-1 tracking-widest uppercase">Padang Sidimpuan Depan Tugu Salak</p>
                    </div>
                    <div class="text-sm md:text-lg font-light text-gray-300 flex flex-col gap-1 items-center mb-8">
                        <p class="italic">"Biarkan gayamu bicara!"</p>
                        <p>"Mode yang cocok untuk setiap langkah Anda"</p>
                        <p class="text-accent font-medium mt-1">"Tampil percaya diri dengan sepatu Yusuf_Store25"</p>
                    </div>
                    <button onclick="showSection('catalog')" class="bg-accent text-black font-extrabold py-3 px-10 rounded-full transition duration-300 hover:bg-white hover:scale-105 shadow-[0_0_20px_rgba(204,255,0,0.5)] uppercase tracking-widest text-xs md:text-sm">Belanja Sekarang</button>
                </div>
            </section>
            <section class="py-16 container mx-auto px-4">
                <div class="text-center mb-12">
                    <span class="inline-block border-b-2 border-accent pb-2"><h3 class="font-bold text-lg md:text-3xl text-white uppercase tracking-widest">Pilih Brand Favorit Mu</h3></span>
                </div>
                <div class="grid grid-cols-3 md:grid-cols-6 gap-3 md:gap-6" id="brandContainer"></div>
            </section>
        </div>

        <!-- Catalog Section -->
        <section id="catalog" class="page-section hidden py-10 min-h-screen">
            <div class="container mx-auto px-4">
                <div class="flex flex-col md:flex-row justify-between items-center mb-8 bg-zinc-900 border border-zinc-800 p-4 rounded-xl gap-4 relative md:sticky md:top-24 z-40 shadow-xl">
                    <div class="flex items-center gap-2"><i class="fas fa-filter text-accent"></i><h2 class="text-lg font-bold text-white uppercase tracking-wider">Katalog</h2></div>
                    <div class="flex flex-col md:flex-row gap-4 w-full md:w-auto items-center">
                        <select onchange="sortProducts(this.value)" class="bg-black text-gray-300 border border-zinc-700 rounded px-3 py-2 text-xs focus:border-accent outline-none w-full md:w-auto">
                            <option value="default">Urutkan</option>
                            <option value="low">Harga Terendah</option>
                            <option value="high">Harga Tertinggi</option>
                        </select>
                        <div class="flex flex-wrap justify-center gap-2">
                            <button onclick="filterCategory('all')" class="cat-btn active bg-accent text-black font-bold px-4 py-1.5 rounded-full text-xs hover:bg-white hover:text-black transition">Semua</button>
                            <button onclick="filterCategory('Running')" class="cat-btn bg-black text-gray-400 border border-zinc-700 px-4 py-1.5 rounded-full text-xs hover:border-accent hover:text-black hover:bg-accent transition">Running</button>
                            <button onclick="filterCategory('Casual')" class="cat-btn bg-black text-gray-400 border border-zinc-700 px-4 py-1.5 rounded-full text-xs hover:border-accent hover:text-black hover:bg-accent transition">Casual</button>
                            <button onclick="filterCategory('Futsal')" class="cat-btn bg-black text-gray-400 border border-zinc-700 px-4 py-1.5 rounded-full text-xs hover:border-accent hover:text-black hover:bg-accent transition">Futsal</button>
                            <button onclick="filterCategory('Basket')" class="cat-btn bg-black text-gray-400 border border-zinc-700 px-4 py-1.5 rounded-full text-xs hover:border-accent hover:text-black hover:bg-accent transition">Basket</button>
                            <button onclick="filterCategory('Kaos')" class="cat-btn bg-black text-gray-400 border border-zinc-700 px-4 py-1.5 rounded-full text-xs hover:border-accent hover:text-black hover:bg-accent transition">Kaos</button>
                            <button onclick="filterCategory('Jam Tangan')" class="cat-btn bg-black text-gray-400 border border-zinc-700 px-4 py-1.5 rounded-full text-xs hover:border-accent hover:text-black hover:bg-accent transition">Jam Tangan</button>
                        </div>
                    </div>
                </div>
                <div class="bg-zinc-900/50 border-l-4 border-accent p-3 mb-8 text-xs text-gray-300"><i class="fas fa-truck mr-2"></i> Siap kirim ke seluruh Indonesia dengan packing aman!</div>
                <div id="productGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6"></div>
                <div id="emptyState" class="hidden text-center py-20 text-gray-600"><i class="fas fa-box-open text-6xl mb-4"></i><p>Barang tidak ditemukan.</p></div>
            </div>
        </section>

        <!-- Galeri Section (Dynamic) -->
        <section id="gallery" class="page-section hidden py-16 container mx-auto px-4 bg-black">
            <div class="text-center mb-12">
                <h2 class="text-2xl font-bold text-white mb-2 uppercase tracking-widest">Galeri Pembeli</h2>
                <div class="h-1 w-20 bg-accent mx-auto rounded"></div>
                <p class="text-gray-400 text-xs mt-4">Klik foto untuk melihat lebih jelas</p>
            </div>
            <!-- Container untuk Data Firebase -->
            <div class="grid grid-cols-3 md:grid-cols-6 gap-2 md:gap-4" id="galleryGrid">
                <!-- Data will be loaded here from Firebase -->
            </div>
        </section>

        <!-- Testimonial Section -->
        <section id="testimonials" class="page-section hidden py-16 container mx-auto px-4 bg-zinc-900/30">
            <div class="text-center mb-12">
                <h2 class="text-2xl font-bold text-white mb-4 uppercase tracking-widest">Kata Mereka</h2>
            </div>
            <div id="testimoniGrid" class="grid md:grid-cols-3 gap-6">
                <!-- Data will be loaded here from Firebase -->
            </div>
        </section>

        <section id="sizeguide" class="page-section hidden py-12 min-h-screen">
            <div class="container mx-auto px-4 max-w-4xl">
                <div class="bg-zinc-900 border border-zinc-800 rounded-lg p-6 shadow-lg">
                    <h2 class="text-xl font-bold text-center mb-8 text-white uppercase">Size Guide</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-sm md:text-base text-gray-300 text-center">
                            <thead><tr class="border-b border-zinc-700 text-accent"><th class="py-3">EUR</th><th>US</th><th>CM</th></tr></thead>
                            <tbody class="divide-y divide-zinc-800">
                                <tr><td class="py-3">39</td><td>6.5</td><td>24.5</td></tr>
                                <tr><td class="py-3">40</td><td>7</td><td>25</td></tr>
                                <tr><td class="py-3">41</td><td>8</td><td>26</td></tr>
                                <tr><td class="py-3">42</td><td>8.5</td><td>26.5</td></tr>
                                <tr><td class="py-3">43</td><td>9.5</td><td>27.5</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <div id="shipping-location-section" class="page-section hidden py-10 min-h-screen">
            <div class="container mx-auto px-4 grid md:grid-cols-3 gap-8">
                <section id="ongkir" class="bg-zinc-900 border border-zinc-800 p-6 rounded-lg md:col-span-2">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2 text-white uppercase"><i class="fas fa-truck text-accent"></i> Cek Ongkir</h3>
                    <form id="shippingForm" onsubmit="checkShipping(event)" class="space-y-4">
                        <input type="text" id="destination" required placeholder="Kecamatan Tujuan" class="w-full bg-black border border-zinc-700 rounded p-3 text-white text-sm">
                        <button type="submit" class="w-full bg-accent text-black font-bold py-3 rounded text-sm uppercase">Cek Ongkir</button>
                    </form>
                    <div id="shippingResult" class="hidden mt-6 p-4 bg-accent/10 border border-accent/20 rounded text-sm text-accent"><p class="text-gray-300">Untuk tarif real-time ke <span id="destResult" class="font-bold text-white"></span>, silakan chat admin.</p></div>
                </section>
                <section id="location" class="bg-zinc-900 border border-zinc-800 p-6 rounded-lg md:col-span-1">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2 text-white uppercase"><i class="fas fa-map-pin text-accent"></i> Lokasi</h3>
                    <div class="w-full h-48 bg-zinc-800 rounded overflow-hidden grayscale hover:grayscale-0 transition duration-500"><iframe width="100%" height="100%" frameborder="0" style="border:0" src="https://maps.google.com/maps?q=1.3759020665545012,99.27329924966573&z=16&output=embed" allowfullscreen></iframe></div>
                </section>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-black text-white pt-16 pb-8 border-t border-zinc-900">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-3 gap-8 mb-12">
                <div class="text-center md:text-left">
                    <h2 class="font-display font-bold text-2xl text-white mb-4 uppercase tracking-wider">Yusuf Store 25</h2>
                    <p class="text-gray-400 text-sm mb-6 leading-relaxed">Pusat sepatu berkualitas di Padang Sidimpuan. Menyediakan berbagai brand ternama seperti Adidas, Nike, New Balance, dan lainnya dengan kualitas terbaik.</p>
                    <div class="flex justify-center md:justify-start gap-4">
                        <a href="https://www.instagram.com/yusuf_store_25?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw%3D%3D" target="_blank" class="w-10 h-10 rounded-full bg-zinc-900 flex items-center justify-center text-gray-400 hover:bg-accent hover:text-black transition"><i class="fab fa-instagram"></i></a>
                        <a href="https://wa.me/6281375861195" target="_blank" class="w-10 h-10 rounded-full bg-zinc-900 flex items-center justify-center text-gray-400 hover:bg-accent hover:text-black transition"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="text-center md:text-left">
                    <h3 class="font-bold text-lg text-white mb-4 uppercase tracking-wide">Alamat & Kontak</h3>
                    <ul class="space-y-4 text-sm text-gray-400">
                        <li class="flex flex-col md:flex-row items-center md:items-start gap-3"><i class="fas fa-map-marker-alt text-accent mt-1"></i><span>Depan Tugu Salak,<br>Padang Sidimpuan,<br>Sumatera Utara, Indonesia</span></li>
                        <li class="flex flex-col md:flex-row items-center md:items-start gap-3"><i class="fab fa-whatsapp text-accent mt-1"></i><span>+62 813-7586-1195</span></li>
                        <li class="flex flex-col md:flex-row items-center md:items-start gap-3"><i class="fas fa-clock text-accent mt-1"></i><span>Buka Setiap Hari: 10.00 - 22.00 WIB</span></li>
                    </ul>
                </div>
                <div class="text-center md:text-left">
                     <h3 class="font-bold text-lg text-white mb-4 uppercase tracking-wide">Lokasi Kami</h3>
                     <div class="w-full h-48 bg-zinc-800 rounded-lg overflow-hidden border border-zinc-800 grayscale hover:grayscale-0 transition duration-500"><iframe width="100%" height="100%" frameborder="0" style="border:0" src="https://maps.google.com/maps?q=1.3759020665545012,99.27329924966573&z=16&output=embed" allowfullscreen loading="lazy"></iframe></div>
                     <a href="https://maps.google.com/maps?q=1.3759020665545012,99.27329924966573" target="_blank" class="inline-block mt-3 text-xs text-accent hover:text-white transition border-b border-accent pb-0.5">Buka di Google Maps <i class="fas fa-external-link-alt ml-1"></i></a>
                </div>
            </div>
            <div class="border-t border-zinc-900 pt-8 text-center">
                <p class="text-gray-500 text-sm">© 2025 Yusuf Store 25. All rights reserved.</p>
                <a href="#" onclick="adminLogin(event)" class="hover:text-accent transition mt-2 inline-block text-[10px] uppercase tracking-widest text-gray-700">Admin Login</a>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <!-- GALLERY MODAL (Updated for Video) -->
    <div id="imageModal" class="fixed inset-0 z-[100] hidden flex items-center justify-center bg-black/95 p-4" onclick="closeModal()">
        <div class="relative w-full h-full flex items-center justify-center">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-500 hover:text-white text-3xl z-50">✕</button>
            <img id="modalImg" src="" class="max-h-[85vh] max-w-full object-contain rounded border border-zinc-800 hidden">
            <video id="modalVideo" class="max-h-[85vh] max-w-full object-contain rounded border border-zinc-800 hidden" controls autoplay playsinline></video>
        </div>
    </div>

    <!-- PRODUCT DETAIL MODAL -->
    <div id="productModal" class="fixed inset-0 z-[100] hidden flex items-center justify-center bg-black/90 p-4 backdrop-blur-sm" onclick="if(event.target === this) closeProductModal()">
        <div class="bg-zinc-900 border border-zinc-800 w-full max-w-3xl rounded-xl overflow-hidden flex flex-col md:flex-row shadow-2xl relative">
            <button onclick="closeProductModal()" class="absolute top-4 right-4 text-gray-400 hover:text-white z-10 bg-black/50 rounded-full w-8 h-8 flex items-center justify-center"><i class="fas fa-times"></i></button>
            <div class="w-full md:w-1/2 bg-black flex items-center justify-center p-4 relative group"><img id="pmImage" src="" class="max-h-[300px] md:max-h-[400px] object-contain transition duration-300 group-hover:scale-105"><div id="pmBadge" class="absolute top-4 left-4 px-3 py-1 rounded text-xs font-bold shadow-lg"></div></div>
            <div class="w-full md:w-1/2 p-6 flex flex-col"><div class="mb-auto"><p id="pmBrand" class="text-accent text-xs font-bold uppercase tracking-widest mb-2">BRAND</p><h2 id="pmName" class="text-xl md:text-2xl font-bold text-white mb-2 leading-tight">Product Name</h2><div class="flex items-end gap-3 mb-6"><span id="pmPrice" class="text-xl font-bold text-white">Rp 0</span><span id="pmOriginalPrice" class="text-sm text-gray-500 line-through mb-1 hidden">Rp 0</span></div><div id="pmSizeSection" class="mb-6"><p class="text-sm text-gray-400 mb-2 font-bold flex justify-between">Pilih Ukuran: <span id="selectedSizeDisplay" class="text-accent"></span></p><div id="pmSizes" class="flex flex-wrap gap-2"></div><p id="pmSizeWarning" class="text-red-500 text-xs mt-2 hidden animate-pulse"><i class="fas fa-exclamation-circle mr-1"></i>Silakan pilih ukuran terlebih dahulu!</p></div></div><div class="mt-4 pt-4 border-t border-zinc-800"><a id="pmBuyBtn" href="#" target="_blank" onclick="return validateSize()" class="block w-full bg-accent hover:bg-white text-black text-center font-bold py-3 rounded-lg transition uppercase tracking-widest shadow-[0_0_15px_rgba(204,255,0,0.3)] hover:shadow-[0_0_25px_rgba(204,255,0,0.5)]"><i class="fab fa-whatsapp mr-2"></i> Beli Sekarang</a><p class="text-[10px] text-center text-gray-500 mt-2">Transaksi aman & terpercaya via WhatsApp</p></div></div>
        </div>
    </div>

    <!-- ADMIN MODAL -->
    <div id="adminModal" class="fixed inset-0 z-[90] hidden flex items-center justify-center bg-black/90 p-4 backdrop-blur-sm">
        <div class="bg-zinc-900 border border-zinc-800 rounded-lg w-full max-w-lg p-6 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6 border-b border-zinc-800 pb-4"><h2 class="text-xl font-bold text-white uppercase tracking-wider">Admin Panel</h2><button onclick="closeAdmin()" class="text-gray-500 hover:text-red-500"><i class="fas fa-times"></i></button></div>
            
            <div class="flex mb-6 bg-black rounded p-1 overflow-x-auto">
                <button onclick="showAdminTab('dashboard')" id="tabDashboard" class="flex-1 py-2 px-2 rounded text-xs font-bold uppercase bg-zinc-800 text-white transition whitespace-nowrap">Home</button>
                <button onclick="showAdminTab('add')" id="tabAdd" class="flex-1 py-2 px-2 rounded text-xs font-bold uppercase text-gray-500 hover:text-white transition whitespace-nowrap">Produk</button>
                <button onclick="showAdminTab('list')" id="tabList" class="flex-1 py-2 px-2 rounded text-xs font-bold uppercase text-gray-500 hover:text-white transition whitespace-nowrap">Kelola</button>
                <button onclick="showAdminTab('gallery')" id="tabGallery" class="flex-1 py-2 px-2 rounded text-xs font-bold uppercase text-gray-500 hover:text-white transition whitespace-nowrap">Galeri</button>
                <button onclick="showAdminTab('brand')" id="tabBrand" class="flex-1 py-2 px-2 rounded text-xs font-bold uppercase text-gray-500 hover:text-white transition whitespace-nowrap">Brand</button>
                <button onclick="showAdminTab('testimoni')" id="tabTestimoni" class="flex-1 py-2 px-2 rounded text-xs font-bold uppercase text-gray-500 hover:text-white transition whitespace-nowrap">Testi</button>
                <button onclick="showAdminTab('settings')" id="tabSettings" class="flex-1 py-2 px-2 rounded text-xs font-bold uppercase text-gray-500 hover:text-white transition whitespace-nowrap"><i class="fas fa-cog"></i></button>
            </div>

            <!-- Dashboard Section -->
            <div id="adminDashboardSection">
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div class="bg-zinc-800 p-4 rounded border border-zinc-700"><div class="text-xs text-gray-400 uppercase tracking-widest">Total Produk</div><div class="text-2xl font-bold text-white" id="statTotalProducts">0</div></div>
                    <div class="bg-zinc-800 p-4 rounded border border-zinc-700"><div class="text-xs text-gray-400 uppercase tracking-widest">Estimasi Aset</div><div class="text-lg font-bold text-accent" id="statTotalAsset">Rp 0</div></div>
                    <div class="bg-zinc-800 p-4 rounded border border-zinc-700"><div class="text-xs text-gray-400 uppercase tracking-widest">Ready Stock</div><div class="text-2xl font-bold text-green-500" id="statReady">0</div></div>
                    <div class="bg-zinc-800 p-4 rounded border border-zinc-700"><div class="text-xs text-gray-400 uppercase tracking-widest">Sold Out</div><div class="text-2xl font-bold text-red-500" id="statSold">0</div></div>
                </div>
            </div>

            <!-- Gallery Section -->
            <div id="adminGallerySection" class="hidden space-y-6">
                <div class="bg-zinc-800 p-4 rounded border border-zinc-700">
                    <h3 class="text-white font-bold mb-3 uppercase text-xs tracking-wider">Tambah Foto Galeri</h3>
                    <div class="space-y-3">
                        <select id="galleryTypeInput" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                            <option value="image">Foto (Upload)</option>
                        </select>
                        <input type="file" id="galleryFileInput" accept="image/*" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                        <button onclick="addGalleryToFirebase()" class="w-full bg-accent text-black font-bold py-2 rounded text-xs hover:bg-white transition">Upload Foto</button>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="text-white font-bold uppercase text-xs tracking-wider">Daftar Galeri</h3>
                        <button onclick="resetGallery()" class="text-[10px] text-red-500 hover:text-red-400 border border-red-900 bg-red-900/20 px-2 py-1 rounded transition"><i class="fas fa-trash-alt mr-1"></i> Hapus Semua (Reset)</button>
                    </div>
                    <div id="adminGalleryList" class="space-y-2 max-h-60 overflow-y-auto"></div>
                    <div class="mt-4 pt-4 border-t border-zinc-800 text-center">
                        <p class="text-[10px] text-gray-500 mb-2">Belum ada Foto di Database?</p>
                        <button id="btnMigrateGallery" onclick="migrateGalleryToFirebase()" class="w-full bg-indigo-900/50 hover:bg-indigo-800 text-indigo-200 border border-indigo-700 py-3 rounded text-xs font-bold uppercase tracking-widest transition"><i class="fas fa-cloud-upload-alt mr-2"></i>Upload Galeri Bawaan</button>
                        <p id="migrateMsg" class="text-[9px] text-red-400 mt-2 italic">*Video bawaan tidak ikut diupload (terlalu besar), hanya foto.</p>
                    </div>
                </div>
            </div>

            <!-- Brand Section -->
            <div id="adminBrandSection" class="hidden space-y-6">
                <div class="bg-zinc-800 p-4 rounded border border-zinc-700">
                    <h3 class="text-white font-bold mb-3 uppercase text-xs tracking-wider">Tambah Brand Baru</h3>
                    <div class="space-y-3">
                        <input type="text" id="brandNameInput" placeholder="Nama Brand (Contoh: Vans)" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                        <input type="file" id="brandLogoInput" accept="image/*" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                        <button onclick="addBrandToFirebase()" class="w-full bg-accent text-black font-bold py-2 rounded text-xs hover:bg-white transition">Simpan Brand</button>
                    </div>
                </div>
                <div>
                    <h3 class="text-white font-bold mb-3 uppercase text-xs tracking-wider">Daftar Brand</h3>
                    <div id="adminBrandList" class="space-y-2 max-h-60 overflow-y-auto"></div>
                    <div class="mt-4 pt-4 border-t border-zinc-800 text-center">
                        <p class="text-[10px] text-gray-500 mb-2">Belum ada Brand di Database?</p>
                        <button id="btnMigrateBrands" onclick="migrateBrandsToFirebase()" class="w-full bg-indigo-900/50 hover:bg-indigo-800 text-indigo-200 border border-indigo-700 py-3 rounded text-xs font-bold uppercase tracking-widest transition"><i class="fas fa-cloud-upload-alt mr-2"></i>Upload Brand Bawaan</button>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="adminSettingsSection" class="hidden space-y-6">
                <div class="bg-zinc-800 p-4 rounded border border-zinc-700">
                    <h3 class="text-white font-bold mb-3 uppercase text-xs tracking-wider">Ubah Banner Utama</h3>
                    <div class="space-y-3">
                        <input type="file" id="bannerImg" accept="image/*" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                        <p class="text-[10px] text-gray-400 italic">*Rekomendasi ukuran: 1920 x 450 px (Landscape) agar tidak pecah/terpotong.</p>
                        <input type="text" id="bannerTitle" placeholder="Judul Banner" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                        <input type="text" id="bannerSubtitle" placeholder="Sub-Judul" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                        <button onclick="saveBannerSettings()" class="w-full bg-accent text-black font-bold py-2 rounded text-xs hover:bg-white transition">Simpan Banner</button>
                    </div>
                </div>
                <div class="bg-zinc-800 p-4 rounded border border-zinc-700">
                    <h3 class="text-white font-bold mb-3 uppercase text-xs tracking-wider">Keamanan</h3>
                    <input type="password" id="newAdminPassword" placeholder="Password Baru" class="w-full bg-black border border-zinc-600 p-3 rounded text-white text-sm mb-3">
                    <button onclick="changePassword()" class="w-full bg-white text-black font-bold py-2 rounded text-sm hover:bg-gray-200 transition">Ganti Password</button>
                </div>
            </div>

            <!-- Testimoni Section -->
            <div id="adminTestimoniSection" class="hidden space-y-6">
                <div class="bg-zinc-800 p-4 rounded border border-zinc-700">
                    <h3 class="text-white font-bold mb-3 uppercase text-xs tracking-wider">Tambah Testimoni</h3>
                    <div class="space-y-3">
                        <input type="text" id="testiName" placeholder="Nama Pembeli" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                        <input type="text" id="testiCity" placeholder="Kota" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                        <textarea id="testiContent" placeholder="Isi Ulasan" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs h-20"></textarea>
                        <select id="testiRating" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                            <option value="5">★★★★★ (5 Bintang)</option>
                            <option value="4">★★★★ (4 Bintang)</option>
                            <option value="3">★★★ (3 Bintang)</option>
                        </select>
                        <input type="file" id="testiPhoto" accept="image/*" class="w-full bg-black border border-zinc-600 p-2 rounded text-white text-xs">
                        <button onclick="addTestimonial()" class="w-full bg-accent text-black font-bold py-2 rounded text-xs hover:bg-white transition">Tambah Testimoni</button>
                    </div>
                </div>
                <div>
                    <h3 class="text-white font-bold mb-3 uppercase text-xs tracking-wider">Daftar Testimoni</h3>
                    <div id="adminTestiList" class="space-y-2 max-h-60 overflow-y-auto"></div>
                </div>
            </div>

            <!-- Add/Edit Section -->
            <div id="adminAddSection" class="hidden">
                <div id="editModeNotice" class="hidden mb-4 bg-yellow-900/30 border border-yellow-700 text-yellow-200 px-4 py-2 rounded text-sm flex justify-between items-center"><span><i class="fas fa-edit mr-2"></i>Mode Edit Produk</span><button onclick="cancelEdit()" class="text-xs bg-yellow-700 hover:bg-yellow-600 px-2 py-1 rounded">Batal</button></div>
                <form id="addProductForm" onsubmit="addProductToFirebase(event)" class="space-y-4">
                    <input type="text" id="addName" required class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm focus:border-accent outline-none" placeholder="Nama Produk">
                    <div class="grid grid-cols-2 gap-4">
                        <select id="addBrand" class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm focus:border-accent outline-none"></select>
                        <select id="addCategory" class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm focus:border-accent outline-none">
                            <option value="Running">Running</option><option value="Casual">Casual</option><option value="Futsal">Futsal</option><option value="Basket">Basket</option><option value="Kaos">Kaos</option><option value="Jam Tangan">Jam Tangan</option>
                        </select>
                    </div>
                    
                    <div class="bg-zinc-800 p-3 rounded border border-zinc-700">
                        <div class="flex justify-between items-end mb-2">
                            <label class="text-[10px] text-gray-400 font-bold uppercase block">Pilih Ukuran Tersedia:</label>
                            <span class="text-[9px] text-yellow-500 italic">*Hapus centang jika ukuran habis</span>
                        </div>
                        <div class="grid grid-cols-6 gap-2 mb-2" id="shoeSizeContainer"></div>
                        <div class="grid grid-cols-6 gap-2" id="shirtSizeContainer"></div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-1"><label class="text-[10px] text-gray-500 font-bold uppercase ml-1">Status Ketersediaan</label><select id="addStockType" class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm focus:border-accent outline-none"><option value="ready">Ready Stock</option><option value="po">Pre-Order (PO)</option></select></div>
                        <div class="space-y-1"><label class="text-[10px] text-gray-500 font-bold uppercase ml-1">Label Tambahan</label><div class="flex flex-col justify-center h-[46px] gap-2 px-2"><label class="flex items-center gap-2 text-xs text-gray-400 cursor-pointer hover:text-white transition"><input type="checkbox" id="addIsOriginal" class="accent-accent"> Original</label><label class="flex items-center gap-2 text-xs text-gray-400 cursor-pointer hover:text-red-500 transition"><input type="checkbox" id="addIsSold" class="accent-red-500"> Sold Out</label></div></div>
                    </div>
                    <input type="number" id="addPrice" required class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm focus:border-accent outline-none" placeholder="Harga Jual">
                    <input type="number" id="addOriginalPrice" class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm focus:border-accent outline-none" placeholder="Harga Coret (Opsional)">
                    <div class="space-y-2"><label class="text-xs text-gray-500 font-bold uppercase">Foto Produk <span id="imgReqText">(Wajib)</span></label><input type="file" id="addImgFile" accept="image/*" class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-xs focus:border-accent outline-none file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-accent file:text-black hover:file:bg-white transition"><p id="editImgHint" class="text-[10px] text-gray-500 hidden">*Kosongkan jika tidak ingin mengubah foto saat edit.</p></div>
                    <div class="flex gap-2"><button type="submit" id="btnSubmit" class="flex-1 bg-white text-black font-bold py-3 rounded hover:bg-accent transition uppercase text-xs tracking-widest mt-2"><span id="btnText">Upload & Simpan</span></button><button type="button" id="cancelEditBtn" onclick="cancelEdit()" class="hidden w-20 bg-zinc-800 text-white border border-zinc-700 font-bold py-3 rounded hover:bg-red-900 transition uppercase text-xs tracking-widest mt-2">Batal</button></div>
                </form>
            </div>
            
            <div id="adminListSection" class="hidden">
                <div class="mb-4"><input type="text" id="adminSearchInput" onkeyup="renderAdminProductList()" placeholder="Cari produk..." class="w-full bg-black border border-zinc-700 rounded p-2 text-sm text-white focus:border-accent outline-none"></div>
                <div id="adminProductListContainer" class="space-y-2 max-h-[300px] overflow-y-auto pr-2"></div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, doc, updateDoc, deleteDoc, query, orderBy, setDoc, getDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";
        
        const firebaseConfig = { apiKey: "AIzaSyC-76DURrn1anKUwwf0seh6vxyjKX-GV8Q", authDomain: "yusus-store.firebaseapp.com", projectId: "yusus-store", storageBucket: "yusus-store.firebasestorage.app", messagingSenderId: "115210326402", appId: "1:115210326402:web:58555cc684a29fabaeff9b", measurementId: "G-299QHZE8CP" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        signInAnonymously(auth).then(() => console.log("Connected")).catch((e) => console.error(e));

        const staticBrands = [{name:"Adidas",logo:"logo_adidas.jpg"},{name:"Nike",logo:"logo_nike.jpg"},{name:"Onitsuka",logo:"logo_Onitsuka.jpg"},{name:"New Balance",logo:"logo_nb.jpg"},{name:"On Cloud",logo:"logo_oncloud.jpg"},{name:"Puma",logo:"puma.jpg"},{name:"Ortuseight",logo:"logo_ortus.jpg"},{name:"910 Nineten",logo:"logo_910.jpg"},{name:"Skechers",logo:"logo_Skechers.jpg"},{name:"Hoka",logo:"logo_hoka.jpg"},{name:"Asics",logo:"logo_Asics.jpg"},{name:"Specs",logo:"logo_specs.jpg"},{name:"Le Coq",logo:"lecoq.jpg"},{name:"Converse",logo:"converse.jpg"},{name:"Saucony",logo:"saucony.jpg"},{name:"Under Armour",logo:"logo_ua.jpg"},{name:"TNF",logo:"tnf.jpg"},{name:"Lacoste",logo:"lacoste.jpg"},{name:"Kanky",logo:"kanky.jpg"},{name:"DNY",logo:"dny.jpg"},{name:"Mills",logo:"mills.jpg"},{name:"Ballerbro",logo:"balero.jpg"},{name:"No Brand",logo:"nobrand.jpg"}];
        // Static Gallery Data for Migration
        const staticGallery = [];
        for(let i=1; i<=12; i++) staticGallery.push({type:'image', src:`pembeli${i}.jpg`});
        staticGallery.push({type:'image', src:'pembeli17.jpg'});
        // Add videos back to static data
        staticGallery.push({type:'video', src:'video_review1.mp4'});
        staticGallery.push({type:'video', src:'video_review2.mp4'});
        staticGallery.push({type:'video', src:'video_review3.mp4'});
        staticGallery.push({type:'video', src:'video_review4.mp4'});

        const staticProducts = [];
        
        let allProducts = [];
        let allBrands = [];
        let allGallery = []; // Store gallery items
        let currentCategory = 'all';
        let editingId = null;
        let currentProductData = null;
        let selectedProductSize = null;

        async function loadBanner() {
            try {
                const docSnap = await getDoc(doc(db, "settings", "banner"));
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    if(data.image) document.getElementById('heroImage').src = data.image;
                    if(data.title) document.getElementById('heroTitle').innerText = data.title;
                    if(data.subtitle) document.getElementById('heroSubtitle').innerText = data.subtitle;
                }
            } catch(e) { console.log("No custom banner"); }
        }

        // Fetch Brands (UPDATED SORTING LOGIC)
        onSnapshot(collection(db, "brands"), (snapshot) => {
            const firebaseBrands = [];
            snapshot.forEach(doc => firebaseBrands.push({ id: doc.id, ...doc.data() }));
            
            const orderMap = staticBrands.map(b => b.name);
            firebaseBrands.sort((a, b) => {
                if (a.name === "No Brand") return 1;
                if (b.name === "No Brand") return -1;

                const idxA = orderMap.indexOf(a.name);
                const idxB = orderMap.indexOf(b.name);
                
                if (idxA !== -1 && idxB !== -1) return idxA - idxB;
                if (idxA !== -1) return -1;
                if (idxB !== -1) return 1;
                return a.name.localeCompare(b.name);
            });

            allBrands = firebaseBrands.length > 0 ? firebaseBrands : staticBrands;
            populateBrandOptions(); 
            renderAdminBrandList();
        });

        // Fetch Gallery (UPDATED: AUTO MERGE STATIC VIDEOS)
        onSnapshot(collection(db, "gallery"), (snapshot) => {
            const firebaseGallery = [];
            snapshot.forEach(doc => firebaseGallery.push({ id: doc.id, ...doc.data() }));
            
            const galleryContainer = document.getElementById('galleryGrid');
            const adminList = document.getElementById('adminGalleryList');
            const migrateBtn = document.getElementById('btnMigrateGallery');
            const migrateMsg = document.getElementById('migrateMsg');
            
            let displayData = [];
            const staticVideos = staticGallery.filter(item => item.type === 'video');

            if (firebaseGallery.length > 0) {
                // If Firebase has data, use Firebase + Static Videos (since videos are not migrated)
                displayData = [...firebaseGallery, ...staticVideos];
                
                // Disable migrate button
                if(migrateBtn) {
                    migrateBtn.disabled = true;
                    migrateBtn.className = "w-full bg-zinc-800 text-gray-500 border border-zinc-700 py-3 rounded text-xs font-bold uppercase tracking-widest cursor-not-allowed";
                    migrateBtn.innerHTML = '<i class="fas fa-check mr-2"></i>Data Sudah Ada di Database';
                    migrateMsg.innerText = "Gunakan tombol Reset (di atas) jika ingin mengupload ulang dari awal.";
                }
            } else {
                displayData = staticGallery; // Fallback
                // Enable migrate button
                if(migrateBtn) {
                    migrateBtn.disabled = false;
                    migrateBtn.className = "w-full bg-indigo-900/50 hover:bg-indigo-800 text-indigo-200 border border-indigo-700 py-3 rounded text-xs font-bold uppercase tracking-widest transition";
                    migrateBtn.innerHTML = '<i class="fas fa-cloud-upload-alt mr-2"></i>Upload Galeri Bawaan';
                    migrateMsg.innerText = "*Video bawaan tidak ikut diupload (terlalu besar), hanya foto.";
                }
            }

            // Render Frontend Gallery
            galleryContainer.innerHTML = displayData.map(item => {
                if(item.type === 'video') {
                    return `<div onclick="viewGalleryMedia('${item.src}', 'video')" class="relative group overflow-hidden rounded-lg aspect-square bg-zinc-800 border border-zinc-700 cursor-pointer">
                        <video class="w-full h-full object-cover pointer-events-none" muted loop playsinline>
                            <source src="${item.src}" type="video/mp4">
                        </video>
                        <div class="absolute inset-0 flex items-center justify-center bg-black/20 group-hover:bg-black/40 transition">
                             <div class="w-10 h-10 rounded-full bg-white/20 backdrop-blur-md flex items-center justify-center border border-white/50 group-hover:scale-110 transition">
                                 <i class="fas fa-play text-white ml-1"></i>
                             </div>
                        </div>
                        <div class="absolute top-2 right-2 bg-accent text-black text-[10px] font-bold px-2 py-1 rounded shadow-md pointer-events-none">
                            VIDEO
                        </div>
                    </div>`; 
                } else {
                    return `<div onclick="viewGalleryMedia('${item.src}', 'image')" class="relative group overflow-hidden rounded-lg aspect-square cursor-pointer">
                        <img src="${item.src}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                        <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"><i class="fas fa-search-plus text-accent text-xl"></i></div>
                    </div>`;
                }
            }).join('');

            // Render Admin Gallery List (Hanya menampilkan yang ada di Firebase)
            if (firebaseGallery.length === 0) {
                adminList.innerHTML = '<p class="text-gray-500 text-[10px] text-center py-2">Belum ada foto yang diupload ke Database.</p>';
            } else {
                adminList.innerHTML = firebaseGallery.map(item => {
                    return `<div class="flex justify-between items-center bg-black p-2 rounded border border-zinc-800">
                        <div class="flex items-center gap-2">
                            <img src="${item.src}" class="w-8 h-8 object-cover rounded">
                            <span class="text-xs text-white">Foto Galeri</span>
                        </div>
                        <button onclick="deleteGallery('${item.id}')" class="text-red-500 hover:text-red-400 ml-2"><i class="fas fa-trash"></i></button>
                    </div>`;
                }).join('');
            }
        });

        // Add Gallery Function
        window.addGalleryToFirebase = async function() {
            const file = document.getElementById('galleryFileInput').files[0];
            if(!file) return alert("Pilih foto terlebih dahulu!");
            
            try {
                const base64 = await compressImage(file, 600); // Reasonable quality
                await addDoc(collection(db, "gallery"), { type: 'image', src: base64, createdAt: new Date().toISOString() });
                alert("Foto berhasil ditambahkan ke Galeri!");
                document.getElementById('galleryFileInput').value = '';
            } catch(e) { alert("Gagal: " + e.message); }
        }

        window.deleteGallery = async function(id) {
            if(confirm("Hapus foto ini dari galeri?")) await deleteDoc(doc(db, "gallery", id));
        }

        window.resetGallery = async function() {
            if(!confirm("PERINGATAN: Tombol ini akan menghapus SEMUA FOTO di galeri Anda (termasuk yang double). Anda harus mengupload ulang setelah ini.\n\nYakin ingin melanjutkan?")) return;
            
            const btn = document.querySelector('button[onclick="resetGallery()"]');
            const originalText = btn.innerHTML;
            btn.innerText = "Menghapus...";
            btn.disabled = true;

            try {
                const snapshot = await getDocs(collection(db, "gallery"));
                const batchPromises = snapshot.docs.map(doc => deleteDoc(doc.ref));
                await Promise.all(batchPromises);
                alert("Galeri berhasil dikosongkan. Silakan upload ulang data bawaan (Cukup klik tombol upload 1 kali).");
            } catch (e) {
                alert("Gagal menghapus: " + e.message);
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        window.migrateGalleryToFirebase = async function() {
            if(!confirm("Upload semua FOTO galeri bawaan ke Firebase? (Video tidak akan diupload)")) return;
            const btn = document.getElementById('btnMigrateGallery');
            btn.disabled = true; btn.innerText = "Memproses...";
            
            let count = 0;
            for(const item of staticGallery) {
                if(item.type === 'image') {
                    try {
                        const response = await fetch(item.src);
                        const blob = await response.blob();
                        const base64 = await new Promise((resolve) => {
                            const reader = new FileReader();
                            reader.onloadend = () => resolve(reader.result);
                            reader.readAsDataURL(blob);
                        });
                        await addDoc(collection(db, "gallery"), { type: 'image', src: base64, createdAt: new Date().toISOString() });
                        count++;
                    } catch(e) { console.log("Skip " + item.src); }
                }
            }
            alert(count + " Foto berhasil dipindahkan!");
            // Button disabled logic handled by onSnapshot
        }

        // Add Brand Function (NEW)
        window.addBrandToFirebase = async function() {
            const name = document.getElementById('brandNameInput').value;
            const file = document.getElementById('brandLogoInput').files[0];
            
            if(!name || !file) return alert("Nama Brand dan Logo wajib diisi!");
            
            try {
                const logo = await compressImage(file, 200); // Resize logo
                // Menambahkan createdAt agar data masa depan lebih rapi
                await addDoc(collection(db, "brands"), { name, logo, createdAt: new Date().toISOString() });
                alert("Brand berhasil ditambahkan!");
                document.getElementById('brandNameInput').value = '';
                document.getElementById('brandLogoInput').value = '';
            } catch(e) {
                alert("Gagal: " + e.message);
            }
        }

        window.deleteBrand = async function(id) {
            if(confirm("Hapus Brand ini?")) await deleteDoc(doc(db, "brands", id));
        }

        window.renderAdminBrandList = function() {
            const container = document.getElementById('adminBrandList');
            container.innerHTML = allBrands.map(b => {
                // Handle static vs firebase data structure
                const isFirebase = !!b.id;
                const deleteBtn = isFirebase ? 
                    `<button onclick="deleteBrand('${b.id}')" class="text-red-500 hover:text-red-400 ml-2"><i class="fas fa-trash"></i></button>` : 
                    `<span class="text-gray-500 text-[10px] italic">Bawaan</span>`;
                
                return `
                <div class="flex justify-between items-center bg-black p-2 rounded border border-zinc-800">
                    <div class="flex items-center gap-2">
                        <img src="${b.logo}" class="w-8 h-8 object-contain bg-white rounded p-1">
                        <span class="text-xs text-white">${b.name}</span>
                    </div>
                    ${deleteBtn}
                </div>`;
            }).join('');
        }

        window.migrateBrandsToFirebase = async function() {
            if(!confirm("Upload semua brand bawaan ke Firebase?")) return;
            const btn = document.getElementById('btnMigrateBrands');
            btn.disabled = true;
            btn.innerText = "Memproses...";
            
            let count = 0;
            for(const b of staticBrands) {
                try {
                    // Coba fetch image lokal
                    const response = await fetch(b.logo);
                    const blob = await response.blob();
                    
                    // Convert blob to base64 via FileReader
                    const base64 = await new Promise((resolve) => {
                        const reader = new FileReader();
                        reader.onloadend = () => resolve(reader.result);
                        reader.readAsDataURL(blob);
                    });
                    
                    await addDoc(collection(db, "brands"), { name: b.name, logo: base64 });
                    count++;
                } catch(e) { console.log("Skip " + b.name); }
            }
            alert(count + " Brand berhasil dipindahkan!");
            btn.disabled = false;
            btn.innerText = "Selesai";
        }

        onSnapshot(collection(db, "testimonials"), (snapshot) => {
            const container = document.getElementById('testimoniGrid');
            const adminList = document.getElementById('adminTestiList');
            
            let html = '';
            let adminHtml = '';

            // Jika ada data di Firebase, gunakan itu
            if (!snapshot.empty) {
                snapshot.forEach(doc => {
                    const data = doc.data();
                    html += `
                    <div class="bg-zinc-900 border border-zinc-800 p-6 rounded-lg hover:border-accent/50 transition duration-300">
                        <div class="text-accent text-xs mb-4">${'★'.repeat(data.rating)}</div>
                        <p class="text-gray-400 text-sm mb-6 leading-relaxed">"${data.content}"</p>
                        <div class="flex items-center gap-4">
                            <img src="${data.photo || 'https://via.placeholder.com/100'}" class="w-10 h-10 rounded-full object-cover border border-zinc-700">
                            <div><p class="font-bold text-sm text-white">${data.name}</p><p class="text-xs text-gray-500 uppercase tracking-wide">${data.city}</p></div>
                        </div>
                    </div>`;
                    adminHtml += `
                    <div class="flex justify-between items-center bg-black p-2 rounded border border-zinc-800">
                        <div class="text-xs text-white">${data.name} (${data.rating}★)</div>
                        <button onclick="deleteTestimonial('${doc.id}')" class="text-red-500 hover:text-red-400"><i class="fas fa-trash"></i></button>
                    </div>`;
                });
            } else {
                // FALLBACK: Tampilkan Testimoni Bawaan jika Firebase kosong
                html = `
                <div class="bg-zinc-900 border border-zinc-800 p-6 rounded-lg hover:border-accent/50 transition duration-300">
                    <div class="text-accent text-xs mb-4">★★★★★</div><p class="text-gray-400 text-sm mb-6 leading-relaxed">"Barang mendarat dengan aman di Medan. Kualitasnya oke banget untuk harga segini. Adminnya ramah poll!"</p>
                    <div class="flex items-center gap-4"><img src="https://images.unsplash.com/photo-1599566150163-29194dcaad36?w=100&auto=format&fit=crop&q=60" class="w-10 h-10 rounded-full object-cover border border-zinc-700"><div><p class="font-bold text-sm text-white">Rudi Hartono</p><p class="text-xs text-gray-500 uppercase tracking-wide">Medan</p></div></div>
                </div>
                <div class="bg-zinc-900 border border-zinc-800 p-6 rounded-lg hover:border-accent/50 transition duration-300">
                    <div class="text-accent text-xs mb-4">★★★★★</div><p class="text-gray-400 text-sm mb-6 leading-relaxed">"Suka banget sama sepatunya, pas di kaki. Pengiriman cepet, packing rapih. Next order lagi disini."</p>
                    <div class="flex items-center gap-4"><img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100&auto=format&fit=crop&q=60" class="w-10 h-10 rounded-full object-cover border border-zinc-700"><div><p class="font-bold text-sm text-white">Siti Aminah</p><p class="text-xs text-gray-500 uppercase tracking-wide">Padang Sidimpuan</p></div></div>
                </div>
                <div class="bg-zinc-900 border border-zinc-800 p-6 rounded-lg hover:border-accent/50 transition duration-300">
                    <div class="text-accent text-xs mb-4">★★★★★</div><p class="text-gray-400 text-sm mb-6 leading-relaxed">"Awalnya ragu karena online, tapi pas sampe barangnya realpict. Thanks Yusuf Store!"</p>
                    <div class="flex items-center gap-4"><img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&auto=format&fit=crop&q=60" class="w-10 h-10 rounded-full object-cover border border-zinc-700"><div><p class="font-bold text-sm text-white">Ferdinand Sianturi</p><p class="text-xs text-gray-500 uppercase tracking-wide">P.Siantar</p></div></div>
                </div>`;
            }
            container.innerHTML = html;
            adminList.innerHTML = adminHtml;
        });

        const q = query(collection(db, "products"), orderBy("createdAt", "desc"));
        onSnapshot(q, (snapshot) => {
            const firebaseProducts = [];
            snapshot.forEach((doc) => firebaseProducts.push({ id: doc.id, ...doc.data(), isFirebase: true }));
            allProducts = [...firebaseProducts, ...staticProducts];
            if(currentCategory === 'all') renderProducts(allProducts); else filterCategory(currentCategory);
            renderDashboard();
            if(!document.getElementById('adminModal').classList.contains('hidden')) renderAdminProductList();
        });

        window.renderDashboard = function() {
            const total = allProducts.length;
            const ready = allProducts.filter(p => !p.sold).length;
            const sold = allProducts.filter(p => p.sold).length;
            const asset = allProducts.filter(p => !p.sold).reduce((acc, curr) => acc + (curr.price || 0), 0);
            document.getElementById('statTotalProducts').innerText = total;
            document.getElementById('statReady').innerText = ready;
            document.getElementById('statSold').innerText = sold;
            document.getElementById('statTotalAsset').innerText = formatRupiah(asset);
        }

        window.openProductModal = function(id) {
            const product = allProducts.find(p => p.id == id);
            if(!product) return;
            currentProductData = product;
            selectedProductSize = null;
            document.getElementById('pmImage').src = product.img;
            document.getElementById('pmBrand').innerText = product.brand;
            document.getElementById('pmName').innerText = product.name;
            document.getElementById('pmPrice').innerText = formatRupiah(product.price);
            const oriEl = document.getElementById('pmOriginalPrice');
            if(product.originalPrice > product.price) { oriEl.innerText = formatRupiah(product.originalPrice); oriEl.classList.remove('hidden'); } else { oriEl.classList.add('hidden'); }
            const badge = document.getElementById('pmBadge');
            if(product.sold) {
                badge.className = "absolute top-4 left-4 px-3 py-1 rounded text-xs font-bold shadow-lg bg-red-600 text-white"; badge.innerText = "SOLD OUT";
                document.getElementById('pmBuyBtn').classList.add('pointer-events-none', 'opacity-50', 'grayscale'); document.getElementById('pmBuyBtn').innerText = "Stok Habis";
            } else if(product.isPO) {
                badge.className = "absolute top-4 left-4 px-3 py-1 rounded text-xs font-bold shadow-lg bg-yellow-500 text-black"; badge.innerText = "PRE-ORDER";
                document.getElementById('pmBuyBtn').classList.remove('pointer-events-none', 'opacity-50', 'grayscale'); document.getElementById('pmBuyBtn').innerHTML = '<i class="fab fa-whatsapp mr-2"></i> Pesan PO Sekarang';
            } else {
                badge.className = "absolute top-4 left-4 px-3 py-1 rounded text-xs font-bold shadow-lg bg-green-500 text-white"; badge.innerText = "READY STOCK";
                document.getElementById('pmBuyBtn').classList.remove('pointer-events-none', 'opacity-50', 'grayscale'); document.getElementById('pmBuyBtn').innerHTML = '<i class="fab fa-whatsapp mr-2"></i> Beli Sekarang';
            }
            const sizeContainer = document.getElementById('pmSizes');
            const sizeSection = document.getElementById('pmSizeSection');
            const warning = document.getElementById('pmSizeWarning');
            const displaySize = document.getElementById('selectedSizeDisplay');
            sizeContainer.innerHTML = ''; warning.classList.add('hidden'); displaySize.innerText = '';
            if (product.sizes && product.sizes.length > 0) {
                sizeSection.classList.remove('hidden');
                product.sizes.forEach(size => {
                    const btn = document.createElement('button');
                    btn.className = "border border-zinc-600 text-gray-300 px-3 py-2 rounded text-sm font-bold hover:border-accent hover:text-accent transition min-w-[40px]";
                    btn.innerText = size; btn.onclick = () => selectSize(size, btn); sizeContainer.appendChild(btn);
                });
            } else { sizeSection.classList.add('hidden'); selectedProductSize = "All Size/Default"; }
            document.getElementById('productModal').classList.remove('hidden');
        }

        window.closeProductModal = function() { document.getElementById('productModal').classList.add('hidden'); }
        window.selectSize = function(size, btnElement) {
            selectedProductSize = size;
            document.getElementById('selectedSizeDisplay').innerText = size;
            document.getElementById('pmSizeWarning').classList.add('hidden');
            const allBtns = document.getElementById('pmSizes').children;
            for(let b of allBtns) { b.className = "border border-zinc-600 text-gray-300 px-3 py-2 rounded text-sm font-bold hover:border-accent hover:text-accent transition min-w-[40px]"; }
            btnElement.className = "bg-accent text-black border border-accent px-3 py-2 rounded text-sm font-bold shadow-[0_0_10px_rgba(204,255,0,0.4)] min-w-[40px] transform scale-105";
        }

        window.validateSize = function() {
            if(!currentProductData) return false;
            const hasSizes = currentProductData.sizes && currentProductData.sizes.length > 0;
            if(hasSizes && (!selectedProductSize || selectedProductSize === "All Size/Default")) {
                document.getElementById('pmSizeWarning').classList.remove('hidden');
                const section = document.getElementById('pmSizeSection');
                section.classList.add('translate-x-[-5px]'); setTimeout(() => section.classList.remove('translate-x-[-5px]'), 100); setTimeout(() => section.classList.add('translate-x-[5px]'), 150); setTimeout(() => section.classList.remove('translate-x-[5px]'), 250);
                return false;
            }
            const phone = "6281375861195";
            let text = `Halo Yusuf Store 25, saya mau order:\n\n*${currentProductData.name}*\n`;
            if(selectedProductSize && selectedProductSize !== "All Size/Default") { text += `Ukuran: *${selectedProductSize}*\n`; }
            text += `Harga: ${formatRupiah(currentProductData.price)}\n\nApakah barang masih ready?`;
            const url = `https://wa.me/${phone}?text=${encodeURIComponent(text)}`;
            window.open(url, '_blank'); return false;
        }

        // New viewGalleryMedia function for videos and images
        window.viewGalleryMedia = function(src, type) {
            const modal = document.getElementById('imageModal');
            const img = document.getElementById('modalImg');
            const vid = document.getElementById('modalVideo');
            
            modal.classList.remove('hidden');
            
            if (type === 'video') {
                img.classList.add('hidden');
                vid.classList.remove('hidden');
                vid.src = src;
                // Note: autoplay is set in HTML, but good to ensure
                vid.play().catch(e => console.log("Autoplay blocked"));
            } else {
                vid.classList.add('hidden');
                vid.pause();
                img.classList.remove('hidden');
                img.src = src;
            }
        }

        window.closeModal = function() { 
            document.getElementById('imageModal').classList.add('hidden'); 
            const vid = document.getElementById('modalVideo');
            vid.pause();
            vid.src = "";
        }

        function compressImage(file, maxWidth = 600) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = (event) => {
                    const img = new Image(); img.src = event.target.result;
                    img.onload = () => {
                        const canvas = document.createElement('canvas'); const scaleSize = maxWidth / img.width; canvas.width = maxWidth; canvas.height = img.height * scaleSize;
                        const ctx = canvas.getContext('2d'); ctx.drawImage(img, 0, 0, canvas.width, canvas.height); resolve(canvas.toDataURL('image/jpeg', 0.7)); 
                    }
                }
                reader.onerror = (error) => reject(error);
            });
        }

        window.saveBannerSettings = async function() {
            const file = document.getElementById('bannerImg').files[0];
            const title = document.getElementById('bannerTitle').value;
            const subtitle = document.getElementById('bannerSubtitle').value;
            const data = {};
            if(title) data.title = title; if(subtitle) data.subtitle = subtitle;
            if(file) { data.image = await compressImage(file, 1200); }
            await setDoc(doc(db, "settings", "banner"), data, { merge: true });
            alert("Banner berhasil diperbarui! Silakan refresh jika gambar belum berubah."); loadBanner();
        }

        window.addTestimonial = async function() {
            const name = document.getElementById('testiName').value; const city = document.getElementById('testiCity').value; const content = document.getElementById('testiContent').value; const rating = document.getElementById('testiRating').value; const file = document.getElementById('testiPhoto').files[0];
            if(!name || !content || !file) return alert("Nama, Isi Ulasan, dan Foto wajib diisi!");
            const photo = await compressImage(file, 200);
            await addDoc(collection(db, "testimonials"), { name, city, content, rating, photo, createdAt: new Date().toISOString() });
            alert("Testimoni berhasil ditambahkan!");
            document.getElementById('testiName').value = ''; document.getElementById('testiCity').value = ''; document.getElementById('testiContent').value = ''; document.getElementById('testiPhoto').value = '';
        }

        window.deleteTestimonial = async function(id) { if(confirm("Hapus testimoni ini?")) await deleteDoc(doc(db, "testimonials", id)); }
        window.changePassword = async function() {
            const newPass = document.getElementById('newAdminPassword').value;
            if(!newPass) return alert("Password tidak boleh kosong");
            try { await setDoc(doc(db, "settings", "admin_config"), { password: newPass }); alert("Password berhasil diubah!"); document.getElementById('newAdminPassword').value = ''; } catch(e) { alert("Gagal ubah password: " + e.message); }
        }

        window.addProductToFirebase = async function(e) {
            e.preventDefault();
            const btnSubmit = document.getElementById('btnSubmit'); const btnText = document.getElementById('btnText'); const fileInput = document.getElementById('addImgFile'); const file = fileInput.files[0];
            if (!editingId && !file) { alert("Pilih foto produk terlebih dahulu!"); return; }
            btnSubmit.disabled = true; btnSubmit.classList.add('opacity-50', 'cursor-not-allowed'); btnText.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Memproses...';
            try {
                if (!auth.currentUser) await signInAnonymously(auth);
                let base64Img = null; if (file) base64Img = await compressImage(file);
                const selectedSizes = []; document.querySelectorAll('.size-checkbox:checked').forEach(cb => selectedSizes.push(cb.value));
                const productData = {
                    name: document.getElementById('addName').value, brand: document.getElementById('addBrand').value, category: document.getElementById('addCategory').value,
                    price: parseInt(document.getElementById('addPrice').value), originalPrice: document.getElementById('addOriginalPrice').value ? parseInt(document.getElementById('addOriginalPrice').value) : null,
                    sold: document.getElementById('addIsSold').checked, isOriginal: document.getElementById('addIsOriginal').checked, isPO: document.getElementById('addStockType').value === 'po',
                    sizes: selectedSizes, createdAt: new Date().toISOString()
                };
                if (base64Img) productData.img = base64Img;
                if (editingId) { const productRef = doc(db, "products", editingId); delete productData.createdAt; await updateDoc(productRef, productData); alert("Produk berhasil diperbarui!"); cancelEdit(); } 
                else { if (!base64Img) throw new Error("Gambar wajib diupload untuk produk baru"); await addDoc(collection(db, "products"), productData); alert("Produk baru berhasil ditambahkan!"); document.getElementById('addProductForm').reset(); document.querySelectorAll('.size-checkbox').forEach(cb => cb.checked = false); }
                showAdminTab('list');
            } catch (error) { console.error("Error: ", error); alert("Gagal: " + error.message); } 
            finally { btnSubmit.disabled = false; btnSubmit.classList.remove('opacity-50', 'cursor-not-allowed'); btnText.innerHTML = editingId ? 'Update Produk' : 'Upload & Simpan'; }
        }

        window.renderAdminProductList = function() {
            const container = document.getElementById('adminProductListContainer');
            const searchQuery = document.getElementById('adminSearchInput').value.toLowerCase();
            const filteredProducts = allProducts.filter(p => p.name.toLowerCase().includes(searchQuery));
            if (filteredProducts.length === 0) { container.innerHTML = '<p class="text-center text-gray-400 py-4">Produk tidak ditemukan.</p>'; return; }
            container.innerHTML = filteredProducts.map(p => {
                let badgeClass = 'bg-green-100 text-green-600', badgeText = 'RDY';
                if (p.sold) { badgeClass = 'bg-red-100 text-red-600'; badgeText = 'SOLD'; } else if (p.isPO) { badgeClass = 'bg-yellow-100 text-yellow-600'; badgeText = 'PO'; }
                return `<div class="flex justify-between items-center bg-gray-50 p-2 rounded border border-gray-200 text-sm hover:bg-gray-100 transition"><div class="flex items-center gap-2 overflow-hidden flex-1"><img src="${p.img}" class="w-10 h-10 rounded object-cover bg-gray-200 border border-gray-300"><div class="truncate"><div class="font-bold text-gray-800 truncate w-24 md:w-36 ${p.sold ? 'line-through text-gray-400' : ''}">${p.name}</div><div class="text-[10px] text-gray-500 font-mono">${p.brand} - ${formatRupiah(p.price)}</div></div></div><div class="flex items-center gap-1"><button onclick="toggleSold('${p.id}', ${p.isFirebase})" class="${badgeClass} border px-2 py-1 rounded text-[10px] font-bold w-12 text-center">${badgeText}</button>${p.isFirebase ? `<button onclick="editProduct('${p.id}')" class="bg-yellow-100 text-yellow-600 border border-yellow-200 p-2 rounded hover:bg-yellow-200 transition"><i class="fas fa-pencil-alt text-xs"></i></button><button onclick="deleteProduct('${p.id}', true)" class="bg-red-100 text-red-500 border border-red-200 p-2 rounded hover:bg-red-200 transition"><i class="fas fa-trash-alt text-xs"></i></button>` : `<button disabled class="text-gray-300 p-2"><i class="fas fa-lock"></i></button>`}</div></div>`
            }).join('');
        }

        window.editProduct = function(id) {
            const p = allProducts.find(x => x.id == id); if(!p) return; editingId = id;
            document.getElementById('addName').value = p.name; document.getElementById('addBrand').value = p.brand; document.getElementById('addCategory').value = p.category; document.getElementById('addPrice').value = p.price; document.getElementById('addOriginalPrice').value = p.originalPrice || ''; document.getElementById('addStockType').value = p.isPO ? 'po' : 'ready'; document.getElementById('addIsOriginal').checked = p.isOriginal; document.getElementById('addIsSold').checked = p.sold;
            document.querySelectorAll('.size-checkbox').forEach(cb => cb.checked = false);
            if (p.sizes && Array.isArray(p.sizes)) { p.sizes.forEach(s => { const cb = document.querySelector(`.size-checkbox[value="${s}"]`); if(cb) cb.checked = true; }); }
            document.getElementById('btnText').innerText = "Update Produk"; document.getElementById('cancelEditBtn').classList.remove('hidden'); document.getElementById('editModeNotice').classList.remove('hidden'); document.getElementById('editImgHint').classList.remove('hidden'); document.getElementById('imgReqText').innerText = "(Opsional)"; showAdminTab('add');
        }

        window.cancelEdit = function() {
            editingId = null; document.getElementById('addProductForm').reset(); document.querySelectorAll('.size-checkbox').forEach(cb => cb.checked = false);
            document.getElementById('btnText').innerText = "Upload & Simpan"; document.getElementById('cancelEditBtn').classList.add('hidden'); document.getElementById('editModeNotice').classList.add('hidden'); document.getElementById('editImgHint').classList.add('hidden'); document.getElementById('imgReqText').innerText = "(Wajib)";
        }

        window.toggleSold = async function(id, isFirebase) { if (isFirebase) { const p = allProducts.find(x => x.id == id); await updateDoc(doc(db, "products", id), { sold: !p.sold }); } else alert("Fitur edit status hanya untuk produk yang diupload ke Firebase."); }
        window.deleteProduct = async function(id, isFirebase) { if (isFirebase && confirm("Yakin ingin menghapus permanen dari Firebase?")) await deleteDoc(doc(db, "products", id)); }
        window.renderProducts = function(data) {
            const grid = document.getElementById('productGrid'); const empty = document.getElementById('emptyState'); grid.innerHTML = ''; if (data.length === 0) { empty.classList.remove('hidden'); return; } else empty.classList.add('hidden');
            data.forEach(product => {
                const imgStyle = product.sold ? 'grayscale opacity-75' : ''; const contentStyle = product.sold ? 'opacity-60' : '';
                let btnText = "Beli Sekarang", btnClass = "bg-white text-black hover:bg-accent";
                if (product.sold) { btnText = "SOLD OUT"; btnClass = "bg-zinc-800 text-gray-500 cursor-not-allowed"; } else if (product.isPO) { btnText = "Pesan PO"; btnClass = "bg-yellow-500 text-black hover:bg-yellow-400"; }
                let priceDisplay = `<span class="text-accent font-bold text-sm md:text-lg border border-accent px-2 py-1 rounded">${formatRupiah(product.price)}</span>`;
                if (product.originalPrice && product.originalPrice > product.price) { const discount = Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100); priceDisplay = `<div class="flex flex-col"><span class="text-[10px] text-gray-400 line-through">${formatRupiah(product.originalPrice)}</span><div class="flex items-center gap-2">${priceDisplay}<span class="text-[10px] bg-red-100 text-red-600 px-1 rounded font-bold">-${discount}%</span></div></div>`; }
                let sizeBadge = ''; if(product.sizes && product.sizes.length > 0) { const displaySizes = product.sizes.slice(0, 4); sizeBadge = `<div class="mt-2 flex flex-wrap gap-1">` + displaySizes.map(s => `<span class="text-[9px] border border-zinc-700 px-1 rounded text-gray-400">${s}</span>`).join('') + (product.sizes.length > 4 ? `<span class="text-[9px] text-gray-500">+${product.sizes.length-4}</span>` : '') + `</div>`; }
                grid.innerHTML += `<div class="product-card bg-zinc-900 rounded-lg shadow-lg border border-zinc-800 overflow-hidden relative group hover:border-accent transition duration-300 flex flex-col"><div class="relative group cursor-pointer h-48 md:h-64 overflow-hidden" onclick="openProductModal('${product.id}')"><img src="${product.img}" alt="${product.name}" class="w-full h-full object-cover ${imgStyle} transition duration-500 group-hover:scale-110">${product.sold ? '<div class="absolute top-2 right-2 bg-red-600 text-white text-[10px] px-2 py-1 rounded font-bold z-20 shadow-md">SOLD OUT</div>' : (product.isPO ? '<div class="absolute top-2 right-2 bg-yellow-500 text-black text-[10px] px-2 py-1 rounded font-bold z-20 shadow-md">PRE-ORDER</div>' : '')}<div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center"><span class="bg-accent text-black px-4 py-2 rounded-full text-xs font-bold uppercase tracking-wider transform translate-y-4 group-hover:translate-y-0 transition duration-300"><i class="fas fa-eye mr-1"></i> Detail</span></div></div><div class="p-3 md:p-4 ${contentStyle} text-gray-300 flex-1 flex flex-col"><div class="flex justify-between items-start mb-1"><p class="text-[10px] text-gray-500 uppercase font-bold tracking-wider">${product.brand}</p>${product.isOriginal && !product.sold ? '<span class="text-[9px] bg-accent/20 text-accent border border-accent/30 px-1.5 rounded font-bold">ORI</span>' : ''}</div><h3 class="font-bold text-sm text-white line-clamp-2 leading-snug mb-1 flex-1 cursor-pointer hover:text-accent transition" onclick="openProductModal('${product.id}')">${product.name}</h3>${sizeBadge}<div class="flex items-center justify-between mt-3 pt-3 border-t border-zinc-800">${priceDisplay}<button onclick="openProductModal('${product.id}')" class="w-8 h-8 rounded-full bg-white text-black flex items-center justify-center hover:bg-accent transition shadow-lg ${product.sold ? 'opacity-50 cursor-not-allowed' : ''}"><i class="fas fa-shopping-bag text-xs"></i></button></div></div></div>`;
            });
        }

        window.formatRupiah = (number) => new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(number);
        window.adminLogin = async function(e) { e.preventDefault(); const inputPass = prompt("Masukkan Password Admin:"); if(!inputPass) return; let realPass = "admin123"; try { const docSnap = await getDoc(doc(db, "settings", "admin_config")); if (docSnap.exists()) realPass = docSnap.data().password; } catch(e) { console.log("Config not found, using default"); } if (inputPass === realPass) { document.getElementById('adminModal').classList.remove('hidden'); renderAdminProductList(); showAdminTab('dashboard'); } else { alert("Password salah!"); } }
        window.closeAdmin = function() { document.getElementById('adminModal').classList.add('hidden'); }
        window.showAdminTab = function(tabName) {
            ['Dashboard', 'Add', 'List', 'Brand', 'Gallery', 'Testimoni', 'Settings'].forEach(t => { const sec = document.getElementById('admin' + t + 'Section'); const btn = document.getElementById('tab' + t); if(sec) sec.classList.add('hidden'); if(btn) btn.className = "flex-1 py-2 px-2 rounded text-xs font-bold uppercase text-gray-500 hover:text-white transition whitespace-nowrap"; });
            const activeSec = document.getElementById('admin' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Section'); const activeBtn = document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1));
            if(activeSec) activeSec.classList.remove('hidden'); if(activeBtn) activeBtn.className = "flex-1 py-2 px-2 rounded text-xs font-bold uppercase bg-zinc-800 text-white transition whitespace-nowrap";
            if(tabName === 'list') renderAdminProductList(); if(tabName === 'brand') renderAdminBrandList(); if(tabName === 'dashboard') renderDashboard();
        }
        window.filterCategory = function(category) { currentCategory = category; document.querySelectorAll('.cat-btn').forEach(btn => { btn.classList.remove('bg-accent', 'text-white'); btn.classList.add('bg-white/10', 'text-white', 'border', 'border-white/20'); }); if(event && event.target) { event.target.classList.remove('bg-white/10', 'border'); event.target.classList.add('bg-accent', 'text-black'); } if (category === 'all') renderProducts(allProducts); else renderProducts(allProducts.filter(p => p.category === currentCategory)); }
        window.filterByBrand = function(brandName) { showSection('catalog'); renderProducts(allProducts.filter(p => p.brand === brandName)); }
        window.searchProduct = function(query) { const lowerQ = query.toLowerCase(); renderProducts(allProducts.filter(p => p.name.toLowerCase().includes(lowerQ) || p.brand.toLowerCase().includes(lowerQ) || p.category.toLowerCase().includes(lowerQ))); }
        window.sortProducts = function(order) { let sorted = [...allProducts]; if (currentCategory !== 'all') sorted = sorted.filter(p => p.category === currentCategory); if (order === 'low') sorted.sort((a, b) => a.price - b.price); else if (order === 'high') sorted.sort((a, b) => b.price - a.price); renderProducts(sorted); }
        window.showSection = function(sectionId) { document.querySelectorAll('.page-section').forEach(s => s.classList.add('hidden')); document.getElementById(sectionId).classList.remove('hidden'); window.scrollTo(0, 0); }
        window.openModal = function(id) { const product = allProducts.find(p => p.id == id); if(!product) return; document.getElementById('modalImg').src = product.img; document.getElementById('imageModal').classList.remove('hidden'); }
        window.closeModal = function() { document.getElementById('imageModal').classList.add('hidden'); }
        window.viewGalleryImage = function(src) { document.getElementById('modalImg').src = src; document.getElementById('imageModal').classList.remove('hidden'); }
        window.toggleMenu = function() { document.getElementById('mobileMenu').classList.toggle('hidden'); }
        
        window.populateBrandOptions = function() {
            document.getElementById('addBrand').innerHTML = allBrands.map(b => `<option value="${b.name}">${b.name}</option>`).join('');
            document.getElementById('brandContainer').innerHTML = allBrands.map(b => `<div onclick="filterByBrand('${b.name}')" class="brand-logo cursor-pointer bg-white p-2 rounded-lg flex items-center justify-center h-16 md:h-20 shadow-lg border border-gray-200 hover:bg-accent transition group overflow-hidden relative"><img src="${b.logo}" alt="${b.name}" class="max-h-full max-w-full object-contain group-hover:scale-110 transition duration-300 z-10 relative"><span class="absolute text-[10px] text-gray-300 font-bold opacity-0">${b.name}</span></div>`).join('');
            
            const shoeSizes = [33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45];
            const shirtSizes = ['S', 'M', 'L', 'XL', 'XXL', '3XL'];
            document.getElementById('shoeSizeContainer').innerHTML = shoeSizes.map(s => `<label class="cursor-pointer"><input type="checkbox" value="${s}" class="size-checkbox hidden"><div class="text-[10px] text-center border border-gray-600 rounded py-1 text-gray-400 hover:border-accent hover:text-accent transition">${s}</div></label>`).join('');
            document.getElementById('shirtSizeContainer').innerHTML = shirtSizes.map(s => `<label class="cursor-pointer"><input type="checkbox" value="${s}" class="size-checkbox hidden"><div class="text-[10px] text-center border border-gray-600 rounded py-1 text-gray-400 hover:border-accent hover:text-accent transition">${s}</div></label>`).join('');
        }

        window.onload = () => { 
            showSection('home-section'); 
            loadBanner(); 
        }
    </script>
</body>
</html>