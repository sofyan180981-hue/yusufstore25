<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yusuf Store 25 - Pusat Sepatu Padang Sidimpuan</title>

    <!-- Meta Tags -->
    <meta name="title" content="Yusuf Store 25 - Pusat Sepatu Padang Sidimpuan">
    <meta name="description" content="Pusat sepatu berkualitas di Padang Sidimpuan. Menyediakan sepatu Running, Casual, Futsal, basket, dan Jam Tangan Original & Premium.">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&family=Russo+One&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                        display: ['Russo One', 'sans-serif'],
                    },
                    colors: {
                        primary: '#000000',
                        accent: '#ccff00',
                        secondary: '#18181b',
                        cardbg: '#121212',
                        mute: '#a1a1aa'
                    }
                }
            }
        }
    </script>
    <style>
        html { scroll-behavior: smooth; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .product-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px -10px rgba(204, 255, 0, 0.15); border-color: #ccff00; }
        #imageModal, #adminModal, #testimoniModal { backdrop-filter: blur(8px); }
        .nav-link.active { color: #ccff00; font-weight: 700; text-shadow: 0 0 10px rgba(204, 255, 0, 0.3); }
        
        /* Loading Spinner */
        .loader {
            border: 4px solid #333;
            border-top: 4px solid #ccff00;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-primary text-gray-200 font-sans pt-16 md:pt-20 min-h-screen selection:bg-accent selection:text-black">

    <!-- Navbar -->
    <nav class="bg-black/90 backdrop-blur-md border-b border-white/10 fixed w-full z-50 top-0">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="#" class="flex items-center gap-2 group" onclick="showSection('home-section'); resetFilter(); return false;">
                <img src="1000108714.jpg" onerror="this.src='https://via.placeholder.com/50'" alt="Logo" class="h-10 w-10 md:h-12 md:w-12 object-cover rounded-full border-2 border-transparent group-hover:border-accent transition duration-300">
                <div class="hidden md:block">
                    <h1 class="font-display font-bold text-xl leading-none text-white tracking-wide group-hover:text-accent transition">Yusuf Store 25</h1>
                    <p class="text-xs text-gray-400 font-mono">Padang Sidimpuan</p>
                </div>
            </a>
            <!-- Desktop Nav -->
            <div class="hidden md:flex items-center space-x-8 text-sm font-bold tracking-wide uppercase">
                <a href="#" onclick="showSection('home-section'); return false;" class="nav-link text-gray-300 hover:text-accent transition">Beranda</a>
                <a href="#" onclick="showSection('catalog'); return false;" class="nav-link text-gray-300 hover:text-accent transition">Katalog</a>
                <a href="#" onclick="showSection('gallery'); return false;" class="nav-link text-gray-300 hover:text-accent transition">Galeri</a>
                <a href="#" onclick="showSection('testimonials'); return false;" class="nav-link text-gray-300 hover:text-accent transition">Testimoni</a>
            </div>
            <!-- Search & Menu -->
            <div class="flex items-center gap-5">
                <div class="hidden md:block relative">
                    <input type="text" placeholder="Cari..." class="bg-zinc-900 border border-zinc-700 rounded-full py-2 px-4 text-sm focus:outline-none focus:border-accent w-48" onkeyup="searchProduct(this.value); showSection('catalog');">
                </div>
                <button class="md:hidden text-2xl text-white hover:text-accent transition" onclick="toggleMenu()"><i class="fas fa-bars"></i></button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden bg-zinc-900 border-t border-white/10 p-4 md:hidden text-white">
            <input type="text" placeholder="Cari barang..." class="w-full bg-black border border-zinc-700 p-2 rounded mb-4 focus:border-accent outline-none" onkeyup="searchProduct(this.value); showSection('catalog'); toggleMenu();">
            <ul class="space-y-4 font-bold uppercase text-sm tracking-wider">
                <li><a href="#" class="block hover:text-accent" onclick="showSection('home-section'); toggleMenu();">Beranda</a></li>
                <li><a href="#" class="block hover:text-accent" onclick="showSection('catalog'); toggleMenu();">Katalog</a></li>
                <li><a href="#" class="block hover:text-accent" onclick="showSection('gallery'); toggleMenu();">Galeri</a></li>
            </ul>
        </div>
    </nav>

    <!-- Floating WA -->
    <a href="https://wa.me/6281375861195" target="_blank" class="fixed bottom-6 right-6 z-50 bg-accent hover:bg-white text-black w-14 h-14 rounded-full shadow-[0_0_20px_rgba(204,255,0,0.4)] flex items-center justify-center text-3xl transition duration-300 border-2 border-black">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- Main Content -->
    <main id="main-content">
        <!-- Home Section -->
        <div id="home-section" class="page-section">
            <section class="relative h-[350px] md:h-[450px] w-full overflow-hidden bg-black">
                <img src="https://images.unsplash.com/photo-1552346154-21d32810aba3?q=80&w=2070&auto=format&fit=crop" class="w-full h-full object-cover opacity-40 grayscale">
                <div class="absolute inset-0 flex flex-col justify-center items-center text-center p-4">
                    <h2 class="text-3xl md:text-5xl font-display uppercase text-white drop-shadow-md mb-2">Yusuf Store 25</h2>
                    <p class="text-gray-300 mb-6">Pusat Sepatu Padang Sidimpuan</p>
                    <button onclick="showSection('catalog')" class="bg-accent text-black font-extrabold py-3 px-10 rounded-full hover:scale-105 transition uppercase tracking-widest text-xs md:text-sm">Belanja Sekarang</button>
                </div>
            </section>
            
            <!-- Brand Grid -->
            <section class="py-16 container mx-auto px-4">
                <h3 class="text-center font-bold text-2xl text-white mb-8 uppercase">Brand Favorit</h3>
                <div class="grid grid-cols-3 md:grid-cols-6 gap-3 md:gap-6" id="brandContainer"></div>
            </section>
        </div>

        <!-- Catalog Section -->
        <section id="catalog" class="page-section hidden py-10 min-h-screen">
            <div class="container mx-auto px-4">
                <!-- Filter -->
                <div class="flex flex-col md:flex-row justify-between items-center mb-8 bg-zinc-900 border border-zinc-800 p-4 rounded-xl gap-4 sticky top-20 z-40 shadow-xl">
                    <div class="flex items-center gap-2">
                        <i class="fas fa-filter text-accent"></i>
                        <h2 class="text-lg font-bold text-white uppercase">Katalog</h2>
                    </div>
                    <div class="flex flex-wrap justify-center gap-2">
                        <button onclick="filterCategory('all')" class="cat-btn active bg-accent text-black font-bold px-4 py-1 rounded-full text-xs">Semua</button>
                        <button onclick="filterCategory('Running')" class="cat-btn bg-black text-gray-400 border border-zinc-700 px-4 py-1 rounded-full text-xs hover:border-accent hover:text-white">Running</button>
                        <button onclick="filterCategory('Casual')" class="cat-btn bg-black text-gray-400 border border-zinc-700 px-4 py-1 rounded-full text-xs hover:border-accent hover:text-white">Casual</button>
                        <button onclick="filterCategory('Futsal')" class="cat-btn bg-black text-gray-400 border border-zinc-700 px-4 py-1 rounded-full text-xs hover:border-accent hover:text-white">Futsal</button>
                        <button onclick="filterCategory('Basket')" class="cat-btn bg-black text-gray-400 border border-zinc-700 px-4 py-1 rounded-full text-xs hover:border-accent hover:text-white">Basket</button>
                    </div>
                </div>

                <!-- Product Grid -->
                <div id="productGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
                    <div class="col-span-full text-center py-10">
                        <div class="loader"></div>
                        <p class="text-gray-400 text-sm mt-4">Memuat data dari Database...</p>
                    </div>
                </div>
                <div id="emptyState" class="hidden text-center py-20 text-gray-600">
                    <i class="fas fa-box-open text-6xl mb-4"></i>
                    <p>Produk tidak ditemukan.</p>
                </div>
            </div>
        </section>

        <!-- Gallery Section -->
        <section id="gallery" class="page-section hidden py-16 container mx-auto px-4">
            <h2 class="text-2xl font-bold text-white text-center mb-8 uppercase">Galeri Pembeli</h2>
            <div class="grid grid-cols-3 md:grid-cols-6 gap-2">
                <div class="aspect-square bg-zinc-800 rounded overflow-hidden cursor-pointer" onclick="viewGalleryImage('pembeli1.jpg')"><img src="pembeli1.jpg" onerror="this.src='https://via.placeholder.com/150'" class="w-full h-full object-cover hover:scale-110 transition"></div>
                <div class="aspect-square bg-zinc-800 rounded overflow-hidden cursor-pointer" onclick="viewGalleryImage('pembeli2.jpg')"><img src="pembeli2.jpg" onerror="this.src='https://via.placeholder.com/150'" class="w-full h-full object-cover hover:scale-110 transition"></div>
                <div class="aspect-square bg-zinc-800 rounded overflow-hidden cursor-pointer" onclick="viewGalleryImage('pembeli3.jpg')"><img src="pembeli3.jpg" onerror="this.src='https://via.placeholder.com/150'" class="w-full h-full object-cover hover:scale-110 transition"></div>
                <!-- Video Placeholder -->
                <div class="relative aspect-square bg-zinc-800 rounded border border-zinc-700 flex items-center justify-center">
                    <i class="fas fa-play text-accent text-2xl"></i>
                    <span class="absolute bottom-2 text-[10px] text-gray-400">Review Video</span>
                </div>
            </div>
        </section>

        <!-- Testimonials -->
        <section id="testimonials" class="page-section hidden py-16 container mx-auto px-4">
            <h2 class="text-2xl font-bold text-white text-center mb-8 uppercase">Testimoni</h2>
            <div class="text-center mb-8">
                <button onclick="openTestiModal()" class="bg-transparent border border-accent text-accent px-6 py-2 rounded text-xs font-bold hover:bg-accent hover:text-black transition">Tulis Ulasan</button>
            </div>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="bg-zinc-900 p-6 rounded border border-zinc-800">
                    <div class="text-accent text-xs mb-2">★★★★★</div>
                    <p class="text-gray-400 text-sm">"Barang mantap, pengiriman cepat ke Medan."</p>
                    <p class="text-white text-xs font-bold mt-4">- Rudi, Medan</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-black text-white py-8 border-t border-zinc-900 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p class="text-xs text-gray-500 mb-4">&copy; 2025 Yusuf Store 25. All Rights Reserved.</p>
            <a href="#" onclick="adminLogin(event)" class="text-[10px] text-gray-600 hover:text-accent">Admin Login</a>
        </div>
    </footer>

    <!-- Modals -->
    <div id="imageModal" class="fixed inset-0 z-[100] hidden flex items-center justify-center bg-black/95 p-4" onclick="closeModal()">
        <img id="modalImg" src="" class="max-h-[85vh] max-w-full rounded border border-zinc-800">
        <button onclick="closeModal()" class="absolute top-4 right-4 text-white text-3xl">✕</button>
    </div>

    <div id="testimoniModal" class="fixed inset-0 z-[90] hidden flex items-center justify-center bg-black/90 p-4 backdrop-blur-sm">
        <div class="bg-zinc-900 border border-zinc-800 rounded w-full max-w-md p-6 relative">
            <button onclick="closeTestiModal()" class="absolute top-2 right-4 text-gray-500 hover:text-white">✕</button>
            <h3 class="text-white font-bold mb-4">Tulis Ulasan</h3>
            <form onsubmit="submitTestimonial(event)" class="space-y-3">
                <input type="text" id="testiName" placeholder="Nama" class="w-full bg-black border border-zinc-700 p-2 rounded text-white text-sm">
                <textarea id="testiReview" placeholder="Ulasan..." class="w-full bg-black border border-zinc-700 p-2 rounded text-white text-sm"></textarea>
                <button class="w-full bg-accent text-black font-bold py-2 rounded text-sm">Kirim WA</button>
            </form>
        </div>
    </div>

    <!-- ADMIN MODAL (UPDATED FOR UPLOAD) -->
    <div id="adminModal" class="fixed inset-0 z-[90] hidden flex items-center justify-center bg-black/90 p-4 backdrop-blur-sm">
        <div class="bg-zinc-900 border border-zinc-800 rounded-lg w-full max-w-lg p-6 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6 border-b border-zinc-800 pb-4">
                <h2 class="text-xl font-bold text-white uppercase">Admin Panel</h2>
                <button onclick="closeAdmin()" class="text-gray-500 hover:text-red-500"><i class="fas fa-times"></i></button>
            </div>

            <div class="flex mb-6 bg-black rounded p-1">
                <button onclick="showAdminTab('add')" id="tabAdd" class="flex-1 py-2 rounded text-xs font-bold bg-zinc-800 text-white">Tambah</button>
                <button onclick="showAdminTab('list')" id="tabList" class="flex-1 py-2 rounded text-xs font-bold text-gray-500">Kelola</button>
            </div>

            <!-- Add Section (UPDATED INPUT FILE) -->
            <div id="adminAddSection">
                <form id="addProductForm" onsubmit="addProductToFirestore(event)" class="space-y-4">
                    <input type="text" id="addName" required class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm focus:border-accent outline-none" placeholder="Nama Produk">
                    <div class="grid grid-cols-2 gap-4">
                        <select id="addBrand" class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm outline-none"></select>
                        <select id="addCategory" class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm outline-none">
                            <option value="Running">Running</option>
                            <option value="Casual">Casual</option>
                            <option value="Futsal">Futsal</option>
                            <option value="Basket">Basket</option>
                            <option value="Kaos">Kaos</option>
                            <option value="Jam Tangan">Jam Tangan</option>
                        </select>
                    </div>
                    <div class="flex gap-4 flex-wrap">
                        <label class="flex items-center gap-2 text-sm text-gray-400"><input type="checkbox" id="addIsOriginal" class="accent-accent"> Original</label>
                        <label class="flex items-center gap-2 text-sm text-gray-400"><input type="checkbox" id="addIsSold" class="accent-red-500"> Sold Out</label>
                        <label class="flex items-center gap-2 text-sm text-gray-400"><input type="checkbox" id="addIsPO" class="accent-yellow-500"> Pre-Order</label>
                    </div>
                    <input type="number" id="addPrice" required class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm outline-none" placeholder="Harga Jual">
                    <input type="number" id="addOriginalPrice" class="w-full bg-black border border-zinc-700 p-3 rounded text-white text-sm outline-none" placeholder="Harga Coret (Opsional)">
                    
                    <!-- INPUT FILE UNTUK UPLOAD -->
                    <div class="relative border-dashed border-2 border-zinc-700 rounded p-4 text-center hover:border-accent transition">
                        <input type="file" id="addImgFile" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                        <div class="text-gray-400 text-xs">
                            <i class="fas fa-cloud-upload-alt text-2xl mb-2 text-accent"></i><br>
                            Klik untuk Upload Foto Produk
                        </div>
                        <p id="fileName" class="text-[10px] text-green-500 mt-2 hidden"></p>
                    </div>
                    
                    <button type="submit" class="w-full bg-white text-black font-bold py-3 rounded hover:bg-accent transition uppercase text-xs tracking-widest mt-2">Simpan ke Database</button>
                </form>
            </div>

            <!-- List Section -->
            <div id="adminListSection" class="hidden">
                <div id="adminProductListContainer" class="space-y-2 max-h-[300px] overflow-y-auto pr-2"></div>
            </div>
        </div>
    </div>

    <!-- SCRIPT UTAMA (MODULE) -->
    <script type="module">
        // Import Firebase Functions
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, onSnapshot, doc, updateDoc, deleteDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-storage.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // Konfigurasi Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyC-76DURrn1anKUwwf0seh6vxyjKX-GV8Q",
            authDomain: "yusus-store.firebaseapp.com",
            projectId: "yusus-store",
            storageBucket: "yusus-store.firebasestorage.app",
            messagingSenderId: "115210326402",
            appId: "1:115210326402:web:58555cc684a29fabaeff9b",
            measurementId: "G-299QHZE8CP"
        };

        // Initialize Firebase Services
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const auth = getAuth(app);

        // Login Anonim (PENTING AGAR BISA UPLOAD)
        signInAnonymously(auth).then(() => console.log("Admin Logged In Anonymously")).catch(console.error);

        // Global Vars
        let products = [];
        let currentCategory = 'all';
        const brands = [
            { name: "Adidas", logo: "logo_adidas.jpg" }, { name: "Nike", logo: "logo_nike.jpg" },
            { name: "Onitsuka", logo: "logo_Onitsuka.jpg" }, { name: "New Balance", logo: "logo_nb.jpg" },
            { name: "On Cloud", logo: "logo_oncloud.jpg" }, { name: "Puma", logo: "puma.jpg" },
            { name: "Ortuseight", logo: "logo_ortus.jpg" }, { name: "910 Nineten", logo: "logo_910.jpg" },
            { name: "Skechers", logo: "logo_Skechers.jpg" }, { name: "Hoka", logo: "logo_hoka.jpg" },
            { name: "Asics", logo: "logo_Asics.jpg" }, { name: "Specs", logo: "logo_specs.jpg" },
            { name: "Le Coq", logo: "lecoq.jpg" }, { name: "Converse", logo: "converse.jpg" },
            { name: "Saucony", logo: "saucony.jpg" }, { name: "Under Armour", logo: "logo_ua.jpg" },
            { name: "TNF", logo: "tnf.jpg" }, { name: "Lacoste", logo: "lacoste.jpg" },
            { name: "Kanky", logo: "kanky.jpg" }, { name: "DNY", logo: "dny.jpg" },
            { name: "Mills", logo: "mills.jpg" }, { name: "Ballerbro", logo: "balero.jpg" },
            { name: "No Brand", logo: "nobrand.jpg" }
        ];

        // --- REALTIME DATA ---
        onSnapshot(collection(db, "products"), (snapshot) => {
            products = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            // Urutkan produk terbaru di atas (jika ada createdAt)
            products.sort((a, b) => (b.createdAt || '').localeCompare(a.createdAt || ''));
            renderProductsList(products);
            renderAdminProductList();
        });

        // --- FUNGSI ADMIN ---
        window.addProductToFirestore = async function(e) {
            e.preventDefault();
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const fileInput = document.getElementById('addImgFile');
            const file = fileInput.files[0];

            if (!file) { alert("Wajib pilih foto produk!"); return; }

            submitBtn.innerText = "Mengupload Foto... (Jangan Tutup)";
            submitBtn.disabled = true;
            submitBtn.classList.remove('bg-white');
            submitBtn.classList.add('bg-gray-500');

            try {
                // 1. Upload ke Storage
                const storageRef = ref(storage, 'products/' + Date.now() + '-' + file.name);
                await uploadBytes(storageRef, file);
                const imgUrl = await getDownloadURL(storageRef);

                // 2. Simpan ke Firestore
                const newProduct = {
                    name: document.getElementById('addName').value,
                    brand: document.getElementById('addBrand').value,
                    category: document.getElementById('addCategory').value,
                    price: parseInt(document.getElementById('addPrice').value),
                    originalPrice: document.getElementById('addOriginalPrice').value ? parseInt(document.getElementById('addOriginalPrice').value) : null,
                    img: imgUrl,
                    sold: document.getElementById('addIsSold').checked,
                    isOriginal: document.getElementById('addIsOriginal').checked,
                    isPO: document.getElementById('addIsPO').checked,
                    createdAt: new Date().toISOString()
                };

                await addDoc(collection(db, "products"), newProduct);
                alert("Produk Berhasil Ditambah!");
                e.target.reset();
                document.getElementById('fileName').classList.add('hidden');
                showAdminTab('list');

            } catch (error) {
                console.error(error);
                alert("Gagal: " + error.message);
            } finally {
                submitBtn.innerText = "Simpan ke Database";
                submitBtn.disabled = false;
                submitBtn.classList.add('bg-white');
                submitBtn.classList.remove('bg-gray-500');
            }
        }

        window.deleteProduct = async function(id) {
            if(confirm("Hapus produk ini permanen?")) {
                try { await deleteDoc(doc(db, "products", id)); } 
                catch (e) { alert(e.message); }
            }
        }

        window.toggleSold = async function(id) {
            const p = products.find(i => i.id === id);
            if(p) await updateDoc(doc(db, "products", id), { sold: !p.sold });
        }

        window.togglePO = async function(id) {
            const p = products.find(i => i.id === id);
            if(p) await updateDoc(doc(db, "products", id), { isPO: !p.isPO });
        }

        // --- Helper Admin UI ---
        document.getElementById('addImgFile').addEventListener('change', function() {
            const fileNameDisplay = document.getElementById('fileName');
            if (this.files[0]) {
                fileNameDisplay.innerText = "Foto dipilih: " + this.files[0].name;
                fileNameDisplay.classList.remove('hidden');
            }
        });

        window.adminLogin = function(e) {
            e.preventDefault();
            const p = prompt("Password Admin:");
            if (p === "admin123") {
                document.getElementById('adminModal').classList.remove('hidden');
                renderAdminProductList();
            } else if (p !== null) alert("Salah bos!");
        }

        window.closeAdmin = () => document.getElementById('adminModal').classList.add('hidden');

        window.showAdminTab = function(t) {
            document.getElementById('adminAddSection').classList.toggle('hidden', t !== 'add');
            document.getElementById('adminListSection').classList.toggle('hidden', t !== 'list');
            document.getElementById('tabAdd').className = t === 'add' ? "flex-1 py-2 rounded text-xs font-bold bg-zinc-800 text-white" : "flex-1 py-2 rounded text-xs font-bold text-gray-500";
            document.getElementById('tabList').className = t === 'list' ? "flex-1 py-2 rounded text-xs font-bold bg-zinc-800 text-white" : "flex-1 py-2 rounded text-xs font-bold text-gray-500";
            if(t === 'list') renderAdminProductList();
        }

        window.renderAdminProductList = function() {
            const c = document.getElementById('adminProductListContainer');
            if(!products.length) { c.innerHTML = '<p class="text-center text-gray-500 py-4">Kosong</p>'; return; }
            c.innerHTML = products.map(p => `
                <div class="flex justify-between items-center bg-zinc-800 p-2 rounded mb-2 border border-zinc-700">
                    <div class="flex items-center gap-2 overflow-hidden flex-1">
                        <img src="${p.img}" class="w-8 h-8 rounded object-cover">
                        <div class="truncate">
                            <div class="font-bold text-gray-200 truncate w-24 text-xs">${p.name}</div>
                            <div class="text-[10px] text-gray-500">${new Intl.NumberFormat('id-ID').format(p.price)}</div>
                        </div>
                    </div>
                    <div class="flex gap-1">
                        <button onclick="togglePO('${p.id}')" class="px-2 py-1 rounded text-[8px] font-bold ${p.isPO ? 'bg-yellow-500 text-black' : 'bg-gray-700 text-gray-300'}">PO</button>
                        <button onclick="toggleSold('${p.id}')" class="px-2 py-1 rounded text-[8px] font-bold ${p.sold ? 'bg-red-500 text-white' : 'bg-green-500 text-white'}">${p.sold ? 'SOLD' : 'RDY'}</button>
                        <button onclick="deleteProduct('${p.id}')" class="text-gray-400 hover:text-red-500 px-2"><i class="fas fa-trash"></i></button>
                    </div>
                </div>
            `).join('');
        }

        // --- UI FUNCTIONS ---
        window.renderProductsList = function(data) {
            const g = document.getElementById('productGrid');
            const e = document.getElementById('emptyState');
            g.innerHTML = '';
            if(!data.length) { e.classList.remove('hidden'); return; }
            e.classList.add('hidden');

            data.forEach(p => {
                const discount = p.originalPrice ? Math.round(((p.originalPrice - p.price) / p.originalPrice) * 100) : 0;
                const priceHtml = p.originalPrice 
                    ? `<div class="flex flex-col"><span class="text-[10px] text-gray-500 line-through">Rp ${new Intl.NumberFormat('id-ID').format(p.originalPrice)}</span><div class="flex items-center gap-1"><span class="text-accent font-bold">Rp ${new Intl.NumberFormat('id-ID').format(p.price)}</span><span class="text-[8px] bg-red-600 text-white px-1 rounded">-${discount}%</span></div></div>`
                    : `<span class="text-accent font-bold">Rp ${new Intl.NumberFormat('id-ID').format(p.price)}</span>`;
                
                let btn = p.sold ? `<button disabled class="w-full bg-gray-600 text-white py-2 rounded text-xs font-bold cursor-not-allowed">SOLD OUT</button>`
                    : `<a href="https://wa.me/6281375861195?text=Halo, saya mau beli ${p.name}" target="_blank" class="block w-full text-center ${p.isPO ? 'bg-yellow-500 text-black' : 'bg-green-600 text-white'} hover:opacity-80 py-2 rounded text-xs font-bold transition">${p.isPO ? 'Pesan PO' : 'Beli WA'}</a>`;

                g.innerHTML += `
                    <div class="product-card bg-zinc-900 rounded-lg border border-zinc-800 overflow-hidden group hover:border-accent">
                        <div class="relative cursor-pointer" onclick="openModal('${p.id}')">
                            <img src="${p.img}" class="w-full h-40 object-cover ${p.sold ? 'grayscale opacity-50' : ''}">
                            ${p.sold ? '<span class="absolute top-2 right-2 bg-red-600 text-white text-[10px] px-2 py-1 rounded font-bold">SOLD</span>' : (p.isPO ? '<span class="absolute top-2 right-2 bg-yellow-500 text-black text-[10px] px-2 py-1 rounded font-bold">PO</span>' : '')}
                        </div>
                        <div class="p-3">
                            <div class="flex justify-between mb-1"><span class="text-[10px] text-gray-500 uppercase">${p.brand}</span> ${p.isOriginal && !p.sold ? '<span class="text-[8px] bg-blue-600 text-white px-1 rounded">ORI</span>' : ''}</div>
                            <h3 class="font-bold text-sm text-white line-clamp-2 mb-2">${p.name}</h3>
                            <div class="flex justify-between items-end mb-3">${priceHtml}</div>
                            ${btn}
                        </div>
                    </div>
                `;
            });
        }

        window.filterCategory = function(cat) {
            currentCategory = cat;
            document.querySelectorAll('.cat-btn').forEach(b => {
                b.classList.remove('bg-accent', 'text-black');
                b.classList.add('bg-black', 'text-gray-400', 'border-zinc-700');
            });
            if(event && event.target) {
                event.target.classList.remove('bg-black', 'text-gray-400', 'border-zinc-700');
                event.target.classList.add('bg-accent', 'text-black');
            }
            const f = cat === 'all' ? products : products.filter(p => p.category === cat);
            renderProductsList(f);
        }

        window.searchProduct = function(q) {
            const low = q.toLowerCase();
            renderProductsList(products.filter(p => p.name.toLowerCase().includes(low) || p.brand.toLowerCase().includes(low)));
        }

        window.sortProducts = function(order) {
            let sorted = [...products];
            if(order === 'low') sorted.sort((a,b) => a.price - b.price);
            if(order === 'high') sorted.sort((a,b) => b.price - a.price);
            renderProductsList(currentCategory === 'all' ? sorted : sorted.filter(p => p.category === currentCategory));
        }

        // --- BASIC UI ---
        window.populateBrandOptions = () => {
            const s = document.getElementById('addBrand');
            const bHtml = document.getElementById('brandContainer');
            if(s) s.innerHTML = brands.map(b => `<option value="${b.name}">${b.name}</option>`).join('');
            if(bHtml) bHtml.innerHTML = brands.map(b => `
                <div onclick="filterByBrand('${b.name}')" class="bg-white p-2 rounded flex items-center justify-center h-16 cursor-pointer hover:scale-105 transition shadow">
                    ${b.logo ? `<img src="${b.logo}" onerror="this.style.display='none';this.nextElementSibling.style.display='block'" class="max-h-full max-w-full"><span style="display:none" class="text-black text-xs font-bold">${b.name}</span>` : `<span class="text-black text-xs font-bold">${b.name}</span>`}
                </div>
            `).join('');
        }

        window.filterByBrand = (name) => {
            showSection('catalog');
            renderProductsList(products.filter(p => p.brand === name));
        }

        window.showSection = (id) => {
            document.querySelectorAll('.page-section').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            window.scrollTo(0,0);
        }

        window.openModal = (id) => {
            const p = products.find(i => i.id === id);
            if(p) {
                document.getElementById('modalImg').src = p.img;
                document.getElementById('imageModal').classList.remove('hidden');
            }
        }
        window.viewGalleryImage = (src) => {
            document.getElementById('modalImg').src = src;
            document.getElementById('imageModal').classList.remove('hidden');
        }
        window.closeModal = () => document.getElementById('imageModal').classList.add('hidden');
        window.toggleMenu = () => document.getElementById('mobileMenu').classList.toggle('hidden');
        
        window.checkShipping = (e) => {
            e.preventDefault();
            const d = document.getElementById('destination').value;
            if(d) {
                document.getElementById('shippingResult').classList.remove('hidden');
                document.getElementById('destResult').innerText = d;
            }
        }

        window.openTestiModal = () => document.getElementById('testimoniModal').classList.remove('hidden');
        window.closeTestiModal = () => document.getElementById('testimoniModal').classList.add('hidden');
        
        window.submitTestimonial = (e) => {
            e.preventDefault();
            const n = document.getElementById('testiName').value;
            const r = document.getElementById('testiReview').value;
            window.open(`https://wa.me/6281375861195?text=Ulasan dari ${n}: ${r}`, '_blank');
            closeTestiModal();
        }

        // Init
        window.onload = () => {
            populateBrandOptions();
            showSection('home-section');
        }
    </script>
</body>
</html>